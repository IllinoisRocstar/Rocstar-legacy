<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Rocstar: RocFracMain.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IRTriangles_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Rocstar
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Rocstar multiphysics simulation application</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('MP_2Source_2RocFracMain_8f90_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MP/Source/RocFracMain.f90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="MP_2Source_2RocFracMain_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!*********************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">!* Illinois Open Source License                                      *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">!* University of Illinois/NCSA                                       * </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">!* Open Source License                                               *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">!* Copyright@2008, University of Illinois.  All rights reserved.     *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">!*  Developed by:                                                    *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">!*     Center for Simulation of Advanced Rockets                     *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">!*     University of Illinois                                        *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">!*     www.csar.uiuc.edu                                             *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">!* Permission is hereby granted, free of charge, to any person       *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">!* obtaining a copy of this software and associated documentation    *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">!* files (the &quot;Software&quot;), to deal with the Software without         *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">!* restriction, including without limitation the rights to use,      *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">!* copy, modify, merge, publish, distribute, sublicense, and/or      *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">!* sell copies of the Software, and to permit persons to whom the    *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">!* Software is furnished to do so, subject to the following          *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">!* conditions:                                                       *</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">!* @ Redistributions of source code must retain the above copyright  * </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">!*   notice, this list of conditions and the following disclaimers.  *</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">!*                                                                   * </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">!* @ Redistributions in binary form must reproduce the above         *</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">!*   copyright notice, this list of conditions and the following     *</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">!*   disclaimers in the documentation and/or other materials         *</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">!*   provided with the distribution.                                 *</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">!* @ Neither the names of the Center for Simulation of Advanced      *</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">!*   Rockets, the University of Illinois, nor the names of its       *</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">!*   contributors may be used to endorse or promote products derived * </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">!*   from this Software without specific prior written permission.   *</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">!*                                                                   *</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">!* THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,   *</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">!* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES   *</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">!* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND          *</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">!* NONINFRINGEMENT.  IN NO EVENT SHALL THE CONTRIBUTORS OR           *</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">!* COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER       * </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">!* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,   *</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">!* ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE    *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">!* USE OR OTHER DEALINGS WITH THE SOFTWARE.                          *</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">!*********************************************************************</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">!* Please acknowledge The University of Illinois Center for          *</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">!* Simulation of Advanced Rockets in works and publications          *</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">!* resulting from this software or its derivatives.                  *</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">!*********************************************************************</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">MODULE</span> <a class="code" href="classrocfracmain.html">rocfracmain</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">!!****h* Rocfrac/Rocfrac/Source/RocFracMain</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">!!  NAME</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">!!    RocFracMain.f90</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">!!  FUNCTION</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">!!    3D Dynamic  Explicit Code  with  ALE  formulation for regressing </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">!!    boundaries Finite Element Analysis Code with additional fracture</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">!!    simulation using cohesive elements.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">!!  USAGE</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">!!    Finite  Element code to solve the 3-Dimensional TRANSIENT structural problem</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">!!  USES</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">!!    RocFracSubInterface, UpdateStructuralSoln, feminp, VolRatio, vol_elem_mat,</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">!!    RocFracInterfaceInitial, RocFracInterfaceBuff,  UpdateMassMatrix, V3D4_volume,</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">!!    max_dt_solid, UpdateRbar,v3d4_ale,V3D10_ALE,FluidPressLoad, TractPressLoad,</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">!!    UpdateStructural,principal_stress,bc_enforce</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">!!    </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">!!    Global variables stored in modules :  ROCSTAR_RocFrac,ROCSTAR_RocFracComm,ROCSTAR_RocFracInterp</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">!!  COPYRIGHT</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">!!    University of Illinois, Urbana-Champaign, (C) 2003</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">!!  AUTHOR</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">!!  principal : M.S. Breitenfeld, P.H. Geubelle</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">!!    - email : brtnfld@uiuc.edu, geubelle@uiuc.edu</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">!!  contributing : Changyu Huang, Amit Acharya</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">!!  CREATION DATE</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">!!       2001</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">!!*****</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="classrocstar__rocfrac.html">rocstar_rocfrac</a> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="classrocstar__rocfraccomm.html">rocstar_rocfraccomm</a></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="classrocstar__rocfracinterp.html">rocstar_rocfracinterp</a></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="classrocfracsubinterface.html">rocfracsubinterface</a></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="classupdatestructuralsoln.html">updatestructuralsoln</a></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordtype">USE </span><a class="code" href="classimplicit__global.html">implicit_global</a></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordtype">IMPLICIT NONE</span> </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">PUBLIC</span> :: <a class="code" href="classrocfracmain.html#a12ffc754c70faa0a4631198391f72205">rocfracfinalize</a>, <a class="code" href="classrocfracmain.html#af8df50c77956c23e6df0da51df12145d">rocfracsoln</a>, <a class="code" href="classrocfracmain.html#a528eefffb0ac5281d70ae23fb12b9350">rocfracinitialize</a></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keyword">CONTAINS</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">! ------------------------------------------------------------------ RocFracInitialize</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classrocfracmain.html#a528eefffb0ac5281d70ae23fb12b9350">  111</a></span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="classrocfracmain.html#a528eefffb0ac5281d70ae23fb12b9350">rocfracinitialize</a>( glb, InitialTime, MPI_COMM_ROCSTAR, MAN_init, surfIn, volIn, obtain_attr)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="classimplicit__global.html">implicit_global</a></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    include <span class="stringliteral">&#39;mpif.h&#39;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    include <span class="stringliteral">&#39;roccomf90.h&#39;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">TYPE(</span><a class="code" href="structrocstar__rocfrac_1_1rocfrac__global.html">rocfrac_global</a><span class="keywordtype">)</span>,<span class="keywordtype">POINTER</span>  :: glb</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">INTENT(IN)</span>            :: initialtime</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>           :: mpi_comm_rocstar</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>           :: man_init, obtain_attr</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">CHARACTER(*)</span>, <span class="keywordtype">INTENT(IN)</span>      :: surfin, volin</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">INTEGER</span> :: <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>,j1,jj,<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>,k1,k2,idum,iaux,iaux1</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">REAL*8</span> :: aux1,aux</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">INTEGER</span> :: ndbcflag</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">INTEGER</span> :: myid, numprocs, ierr</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">INTEGER</span> :: id2d</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">INTEGER</span> :: iunit2</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">INTEGER</span> :: kk</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(3)</span> :: ndsurf</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: buf</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">INTEGER</span> :: idpacket</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordtype">REAL*8</span> :: <a class="code" href="classvector3d.html#acd0002100974a4648cdac68b2d732659">mag</a></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordtype">REAL*8</span> :: ioversion</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordtype">INTEGER</span> :: ios</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordtype">CHARACTER(len=2)</span> :: chr2</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">CHARACTER*120</span> :: frachdffname, meshfile</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">character(LEN=1)</span>, <span class="keywordtype">POINTER</span>, <span class="keywordtype">DIMENSION(:)</span> :: names</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">character(LEN=3)</span> :: ichr03</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">character(LEN=4)</span> :: ichr04</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">integer</span> :: numeltypes2d </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">character(LEN=4)</span> :: chreltype</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">integer</span> :: endpt, startpt, chrlngth</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">INTEGER</span> :: numparcomm</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">dimension(:)</span> :: parcomm</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">pointer</span> :: arraytmp</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">pointer</span>, <span class="keywordtype">dimension(:)</span> :: arraytmp1</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordtype">integer</span> :: iptr</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">integer</span> :: icnt1, icnt2, icnt3, icnt4</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">integer</span> :: iprocs</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">! ... For RocTherm validation, triangular Temp distribution, COstoich 03/18/09</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">REAL*8</span> :: slicetemp, zcoord</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordtype">INTEGER</span> :: <a class="code" href="classvector3d.html#a32a8c538b96dac9c9d9298dd9d071a57">dir</a></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    glb%MPI_COMM_ROCFRAC = mpi_comm_rocstar</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    rocstar_communicator = mpi_comm_rocstar</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    CALL mpi_comm_rank(glb%MPI_COMM_ROCFRAC,myid,ierr)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    CALL mpi_comm_size(glb%MPI_COMM_ROCFRAC,numprocs,ierr)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">WRITE</span>(glb%MyIdChr,<span class="stringliteral">&#39;(i4.4)&#39;</span>) myid</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">! -- Read the control deck file</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">IF</span>(myid.EQ.0) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: Reading input deck&#39;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    glb%io_input = 10</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    glb%io_sum   = 11</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    CALL <a class="code" href="feminp_8f90.html#aabc13a47fa60757716526f304ff82ad6">feminp</a>(glb, myid)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    glb%InterfaceSFNumNodes = 0</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    glb%InterfaceSFnbNumNodes = 0</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: ....Done Reading input deck&#39;</span>,myid</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    CALL mpi_barrier(glb%MPI_COMM_ROCFRAC,ierr)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">! -- Read in roc_face data structure for extracted 2D mesh.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">!    mapnode maps the surface nodes to the volume mesh&#39;s nodes</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">IF</span>(glb%iElType.EQ.4)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       glb%iStrGss = 1</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       glb%LwrBnd = 1</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;       glb%UppBnd = 3</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%iElType.EQ.10)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;       glb%iStrGss = 4</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;       glb%LwrBnd = 4</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;       glb%UppBnd = 6</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%iElType.EQ.8)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;       glb%iStrGss = 1</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;       glb%LwrBnd = 1</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;       glb%UppBnd = 4</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">!   glb%InterfaceSVbar = 0.d0</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordflow">IF</span>(myid.EQ.0) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: Reading Mesh&#39;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">! - Start </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">! - Process the 3D mesh</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">! Number of Nodes</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   CALL com_new_window( volwin)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   CALL com_get_size( volin//<span class="stringliteral">&quot;.nc&quot;</span>, myid+1, glb%NumNP)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   CALL com_set_size( volwin//<span class="stringliteral">&#39;.nc&#39;</span>, myid+1, glb%NumNP   )</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">!   ALLOCATE(glb%coor(1:3,1:glb%NumNP))</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%MeshCoor(1:3,1:glb%NumNP))</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%xmass(1:glb%NumNP))</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordflow">IF</span>(glb%HeatTransSoln) <span class="keyword">ALLOCATE</span>(glb%CapctInv(1:glb%NumNP))</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">!!$          ! Nodal Coordinates</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">!!$          DO i=1,glb%NumNP</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">!!$             ! NodeID, X, Y, Z ! , DummyFlag1</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">!!$             READ(14,*) j,glb%coor(1,i),glb%coor(2,i),glb%coor(3,i) ! ,iaux</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">!!$             </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">!!$             glb%Coor(1,j) =  glb%Coor(1,j)+ mag</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">!!$             glb%Coor(3,j) =  glb%Coor(3,j)+ mag</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">!!$             glb%MeshCoor(1:3,i) = glb%coor(1:3,i)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">!!$          ENDDO</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   CALL com_get_size( volin//<span class="stringliteral">&quot;.bcnode&quot;</span>, myid+1,glb%NumNdsBCcrypt)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%BCFlagCrypt(1:2,1:glb%NumNdsBCcrypt)) <span class="comment">! should this be half NumNdsBCdrypt</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%BCValueGlb(1:glb%NumNdsBCcrypt*6))</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">!!$          ! _________________________________________</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">!!$          ! ___ Read Structural Nodal Boundary Flags</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">!!$          ! _________________________________________</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">!!$          READ(14,*) glb%NumNdsBC ! , iaux</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">!!$          ALLOCATE(glb%BCFlag(1:4,1:glb%NumNdsBC),glb%BCvalue(1:3,1:glb%NumNdsBC))</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">!!$          DO i = 1, glb%NumNdsBC</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">!!$             READ(14,*) glb%BCFlag(1,i),NdBCflag !, iaux</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">!!$             glb%BCFlag(2,i) = glb%bcCond(NdBCflag)%BCtypeX</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">!!$             glb%BCFlag(3,i) = glb%bcCond(NdBCflag)%BCtypeY</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">!!$             glb%BCFlag(4,i) = glb%bcCond(NdBCflag)%BCtypeZ</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">!!$             glb%BCvalue(1,i) = glb%bcCond(NdBCflag)%BCvalueX</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">!!$             glb%BCvalue(2,i) = glb%bcCond(NdBCflag)%BCvalueY</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">!!$             glb%BCvalue(3,i) = glb%bcCond(NdBCflag)%BCvalueZ            </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">!!$          ENDDO</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">!!$!          DEALLOCATE(glb%bcCond)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">!!$       CASE(4)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">!!$          ! Packet 04</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">!!$          ! ___ Read Nodal Mesh Motion Boundary Flags</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">!!$          READ(14,*) glb%NumNdsBCmm !, iaux</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">!!$          IF(glb%NumNdsBCmm.NE.0) ALLOCATE(glb%BCFlagmm(1:4,1:glb%NumNdsBCmm),glb%BCvaluemm(1:3,1:glb%NumNdsBCmm))</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">!!$          IF(glb%ALEenabled)THEN</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">!!$             DO i=1,glb%NumNdsBCmm</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">!!$                READ(14,*) glb%BCFlagmm(1,i) ,NdBCflag !, iaux</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">!!$                glb%BCFlagmm(2,i) = glb%bcCondmm(NdBCflag)%BCtypeX</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">!!$                glb%BCFlagmm(3,i) = glb%bcCondmm(NdBCflag)%BCtypeY</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">!!$                glb%BCFlagmm(4,i) = glb%bcCondmm(NdBCflag)%BCtypeZ</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">!!$                glb%BCvaluemm(1,i) = glb%bcCondmm(NdBCflag)%BCvalueX</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">!!$                glb%BCvaluemm(2,i) = glb%bcCondmm(NdBCflag)%BCvalueY</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">!!$                glb%BCvaluemm(3,i) = glb%bcCondmm(NdBCflag)%BCvalueZ </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">!!$             ENDDO</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">!!$          ELSE</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">!!$             DO i=1,glb%NumNdsBCmm</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">!!$                READ(14,&#39;()&#39;)</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">!!$             ENDDO</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">!!$          ENDIF</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">!!$             </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">!!$!          IF(glb%NumNdsBCmm.NE.0) DEALLOCATE(glb%bcCondmm)</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">!!$ </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;         </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">!!$          ! ___ Read Element Data</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    CALL com_get_connectivities(volin,myid+1,numeltypes2d,names)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    startpt = 1</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, numeltypes2d</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">! Search for the next attribute name</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      endpt = startpt</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      chrlngth = 0</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span> (endpt .LE. ubound(names,1))</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         <span class="keywordflow">IF</span> (names(endpt) .NE. <span class="stringliteral">&#39; &#39;</span>) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            chrlngth = chrlngth + 1</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            chreltype(chrlngth:chrlngth) = names(endpt)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            endpt = endpt + 1</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">END DO</span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      startpt = endpt + 1</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">IF</span>(chreltype(1:chrlngth).EQ.<span class="stringliteral">&#39;:T10&#39;</span>)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;         CALL com_get_size( volin//<span class="stringliteral">&quot;.:T10&quot;</span>, myid+1, glb%NumElVol)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;         CALL com_set_size( volwin//<span class="stringliteral">&#39;.:T10&#39;</span>, myid+1, glb%NumElVol)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(chreltype(1:chrlngth).EQ.<span class="stringliteral">&#39;:T4&#39;</span>)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         CALL com_get_size( volin//<span class="stringliteral">&quot;.:T4&quot;</span>, myid+1, glb%NumElVol)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         CALL com_set_size( volwin//<span class="stringliteral">&#39;.:T4&#39;</span>, myid+1, glb%NumElVol)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(chreltype(1:chrlngth).EQ.<span class="stringliteral">&#39;:H8&#39;</span>)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         CALL com_get_size( volin//<span class="stringliteral">&quot;.:H8&quot;</span>, myid+1, glb%NumElVol)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;         CALL com_set_size( volwin//<span class="stringliteral">&#39;.:H8&#39;</span>, myid+1, glb%NumElVol)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;         <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;ROCFRAC ERROR: Volume mesh type element not supported&#39;</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;Read in Element Type :: &#39;</span>, chreltype(1:chrlngth)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         CALL mpi_finalize(glb%MPI_COMM_ROCFRAC,ierr)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">END DO</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   CALL com_free_buffer(names)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   CALL com_get_array_const(volin//<span class="stringliteral">&quot;.IMP&quot;</span>,myid+1,arraytmp)   </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <span class="keywordflow">IF</span> ( arraytmp == 1 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      glb%IMP = .true.</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="keywordflow">ELSE</span> </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      glb%IMP = .false.</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="keywordflow">IF</span> ( glb%IMP ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keyword">ALLOCATE</span>(nodeproc(1:glb%NumNP))</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keyword">ALLOCATE</span>(local2global(1:glb%NumNp))</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NumNPLocal&quot;</span>,myid+1,arraytmp)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      lnumnp = arraytmp</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NumNPGlobal&quot;</span>,myid+1,arraytmp) </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      gnumnp = arraytmp</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NodeNumGlobal&quot;</span>,myid+1,arraytmp1)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      local2global = arraytmp1</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NodeProc&quot;</span>,myid+1,arraytmp1)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      nodeproc = arraytmp1</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      myid = myid</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      nprocs = numprocs</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">!!$   CALL COM_call_function( obtain_attr, 2, &amp;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">!!$        COM_get_attribute_handle_const( VolIn//&quot;.NumElPartBndry&quot;), &amp;</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">!!$        COM_get_attribute_handle( VolIn//&quot;.NumElPartBndry&quot;))</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">!   stop</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NumElPartBndry&quot;</span>,myid+1,arraytmp)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   glb%NumElPartBndry = arraytmp</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">!!$   CALL COM_call_function( obtain_attr, 2, &amp;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">!!$        COM_get_attribute_handle_const( VolIn//&quot;.NumElVolMat&quot;), &amp;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">!!$        COM_get_attribute_handle( VolIn//&quot;.NumElVolMat&quot;))</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NumElVolMat&quot;</span>,myid+1,arraytmp1)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%NumElVolMat(1:glb%NumMatVol))</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumMatVol</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      glb%NumElVolMat(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = arraytmp1(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   CALL com_get_array_const(volin//<span class="stringliteral">&quot;.NumElPartBndryMat&quot;</span>,myid+1,arraytmp1)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%NumElPartBndryMat(1:glb%NumMatVol))</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumMatVol</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      glb%NumElPartBndryMat(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = arraytmp1(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">IF</span>(.NOT.(glb%DebondPart).AND..NOT.(glb%DebondPart_Matous)) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keyword">ALLOCATE</span>(glb%ci(1:9,1:glb%NumMatVol))</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="keyword">ALLOCATE</span>(glb%cj(1:9,1:glb%NumMatVol))</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keyword">ALLOCATE</span>(glb%ci_full(1:6,1:6,1:glb%NumMatVol))</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 0</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="keywordflow">DO</span> kk = 1, glb%NumMatVol</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="keywordflow">IF</span>(kk.EQ.1)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         <span class="keyword">ALLOCATE</span>(glb%MatIdVol(1:glb%NumElVol))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         <span class="keyword">ALLOCATE</span>(glb%ElConnVol(1:glb%iElType,1:glb%NumElVol))</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">! -- Read element data.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;       </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">IF</span>(glb%NdBasedEl)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <span class="keywordflow">IF</span>(kk.EQ.1)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                   </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <span class="keyword">ALLOCATE</span>(glb%NumElNeigh(1:glb%NumNP))</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keyword">ALLOCATE</span>(glb%ElConnNd(1:glb%NumNP,1:40))</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="keyword">ALLOCATE</span>(glb%AlphaR(1:4,1:glb%NumElVol))</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keyword">ALLOCATE</span>(glb%VolUndfmd(1:glb%NumNP))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            glb%NumElNeigh(:) = 0</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            glb%ElConnNd(:,:) = 0 <span class="comment">! fix not work for more then one material ??</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;         <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">DO</span> jj = 1,glb%NumElVolMat(kk)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;         <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> + 1</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">!!$         IF ( glb%iElType==4) THEN</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">!!$            READ(14,*) glb%MatIdVol(i),glb%ElConnVol(1,i), &amp;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">!!$                 glb%ElConnVol(2,i), glb%ElConnVol(3,i), &amp;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">!!$                 glb%ElConnVol(4,i) !, iaux, iaux</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">!!$         ELSE IF( glb%iElType==10) THEN</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">!!$            READ(14,*) glb%MatIdVol(i),glb%ElConnVol(1,i), &amp;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">!!$                 glb%ElConnVol(2,i), glb%ElConnVol(3,i), &amp;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">!!$                 glb%ElConnVol(4,i), glb%ElConnVol(5,i), &amp;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">!!$                 glb%ElConnVol(6,i), glb%ElConnVol(7,i), &amp;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">!!$                 glb%ElConnVol(8,i), glb%ElConnVol(9,i), &amp;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">!!$                 glb%ElConnVol(10,i) !, iaux, iaux</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">!!$         ELSE IF( glb%iElType==8) THEN</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">!!$            READ(14,*) glb%MatIdVol(i),glb%ElConnVol(1,i), &amp;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">!!$                 glb%ElConnVol(2,i), glb%ElConnVol(3,i), &amp;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">!!$                 glb%ElConnVol(4,i), glb%ElConnVol(5,i), &amp;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">!!$                 glb%ElConnVol(6,i), glb%ElConnVol(7,i), &amp;</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">!!$                 glb%ElConnVol(8,i) !, iaux, iaux</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">!!$         END IF</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;         <span class="keywordflow">IF</span>(glb%NdBasedEl)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                   </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            CALL <a class="code" href="VolRatio_8f90.html#ae26fa72649c2a5908244b9e503f0fc5c">volratio</a>(glb%ElConnVol(1,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%ElConnVol(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%ElConnVol(3,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%ElConnVol(4,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%AlphaR(1:4,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),&amp;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                 glb%MeshCoor,glb%NumNp,glb%NdMassLump)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                   </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, 4</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;               glb%NumElNeigh(glb%ElConnVol(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)) = glb%NumElNeigh(glb%ElConnVol(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)) + 1</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;               glb%ElConnNd(glb%ElConnVol(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%NumElNeigh(glb%ElConnVol(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>))) = <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">! __________________________________________</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">! _______  Parallel Communication</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">! __________________________________________</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;     <span class="keywordflow">IF</span>(numprocs.NE.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">!        CALL COM_set_size( volWin//&#39;.pconn&#39;, ip, NumNeighProcs*2+MaxNumNodesComm)    </span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">!        CALL COM_set_array(volWin//&#39;.pconn&#39;, ip, Pconn_Comm, 1)</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">!!$        CALL COM_new_attribute( volWin//&#39;.NodesToCommunicate&#39;, &#39;p&#39;, COM_INTEGER, 1, &#39;&#39;)</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">!!$        CALL COM_set_size( volWin//&#39;.NodesToCommunicate&#39;, ip, MaxNumNodesComm)    </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">!!$        CALL COM_set_array(volWin//&#39;.NodesToCommunicate&#39;, ip, NodesToCommunicate, 1)</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">!!$        </span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">!!$        CALL COM_new_attribute( volWin//&#39;.ID_sendto_List&#39;, &#39;p&#39;, COM_INTEGER, 1, &#39;&#39;)</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">!!$        CALL COM_set_size( volWin//&#39;.ID_sendto_List&#39;, ip, NumNeighProcs)    </span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">!!$        CALL COM_set_array(volWin//&#39;.ID_sendto_List&#39;, ip, ID_sendto_List, 1)</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">!!$        </span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">!!$        CALL COM_new_attribute( volWin//&#39;.NumNeighProcs_List&#39;, &#39;p&#39;, COM_INTEGER, 1, &#39;&#39;)</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">!!$        CALL COM_set_size( volWin//&#39;.NumNeighProcs_List&#39;, ip, NumNeighProcs)    </span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">!!$        CALL COM_set_array(volWin//&#39;.NumNeighProcs_List&#39;, ip, NumNeighProcs_List, 1)</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        glb%TotNumNeighProcs = 1</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;     </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;     CALL com_get_size( volin//<span class="stringliteral">&quot;.pconn&quot;</span>, myid+1, numparcomm)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;     CALL com_set_size( volwin//<span class="stringliteral">&#39;.pconn&#39;</span>, myid+1, numparcomm)    </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;     CALL com_allocate_array(volwin//<span class="stringliteral">&#39;.pconn&#39;</span>, myid+1, parcomm, 1)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">!!$!</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">!!$! -- Read lst nodes that need to be sent to other processors</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">!!$!</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">!!$          READ(14,*) glb%TotNumNeighProcs</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">!!$!          IF(glb%TotNumNeighProcs.NE.0)THEN</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">!!$             ALLOCATE(glb%NeighProcList(1:glb%TotNumNeighProcs))</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">!!$!          ENDIF</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">!!$          ALLOCATE(glb%NumNdComm(1:glb%TotNumNeighProcs))</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">!!$          ALLOCATE(glb%NdCommList(1:glb%TotNumNeighProcs))</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">!!$          glb%TotNumNdComm = 0</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">!!$! NOTE: NeighProcList is the actual processor starting at id = 0, not 1</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">!!$          DO i = 1, glb%TotNumNeighProcs</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">!!$             READ(14,*) glb%NeighProcList(i),glb%NumNdComm(i)</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">!!$             !       print*,glb%NeighProcList(i),glb%NumNdComm(i)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">!!$             </span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">!!$             glb%TotNumNdComm = glb%TotNumNdComm + glb%NumNdComm(i)</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">!!$             </span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">!!$             ALLOCATE(glb%NdCommList(i)%NdId(1:glb%NumNdComm(i)))</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">!!$             DO j=1,glb%NumNdComm(i)</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">!!$                READ(14,*) glb%NdCommList(i)%NdId(j)</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">!!$             ENDDO</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">!!$          ENDDO</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">!!$          glb%TotNumNdComm = glb%TotNumNdComm*3 ! x3 (x,y,z R_in)</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">!!$       CASE(7)</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">!!$          ! Packet 07</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">!!$          ! ___ Nodal History </span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">!!$          READ(14,*) glb%NumNodeIO</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">!!$          ALLOCATE(glb%NodeIO(1:glb%NumNodeIO))</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">!!$          DO i = 1, glb%NumNodeIO</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">!!$             READ(14,*) glb%NodeIO(i)</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">!!$             WRITE(chr2,&#39;(i2.2)&#39;) i</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">!!$             OPEN(33+i,FILE=&#39;Rocfrac/NdHistory.&#39;//glb%MyIdChr//&#39;.&#39;//chr2)</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">!!$             WRITE(33+i,*) &#39;#&#39;, glb%coor(1:3,glb%NodeIO(i))</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">!!$          ENDDO</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">!!$          CASE(8)</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">!!$          ! Packet 08</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">!!$          ! __________________________________________</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">!!$          ! ___ Nodal History </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">!!$          ! __________________________________________  </span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">!!$             READ(14,*) glb%NumNdsBCHT !, iaux</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">!!$             IF(glb%NumNdsBCHT.NE.0) ALLOCATE(glb%BCFlagHT(1:2,1:glb%NumNdsBCHT),glb%BCvalueHT(1,1:glb%NumNdsBCHT))</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">!!$             DO i=1,glb%NumNdsBCHT</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">!!$                READ(14,*) glb%BCFlagHT(1,i) ,NdBCflag !, iaux</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">!!$                glb%BCFlagHT(2,i) = glb%bcCondHT(NdBCflag)%BCtypeX</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">!!$                glb%BCvalueHT(1,i) = glb%bcCondHT(NdBCflag)%BCvalueX </span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">!!$             ENDDO</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">!!$       CASE(99)</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">!!$          ! Packet 99</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">!!$          ! _____________________________</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">!!$          ! ___ End of Input File</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">!!$          ! _____________________________</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">!!$          EXIT</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">!!$       CASE DEFAULT</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">!!$          PRINT*, &#39;ERROR: ROCFRAC&#39;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">!!$          PRINT*, &#39;Input Packet = &#39;,IdPacket, &#39;Is Not A Valid Option&#39;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">!!$          PRINT*, &#39;Check {prefix}.####.inp files and try again&#39;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">!!$          CALL MPI_BARRIER(glb%MPI_COMM_ROCFRAC,ierr)</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">!!$          CALL MPI_FINALIZE(glb%MPI_COMM_ROCFRAC,ierr)</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">!!$          STOP</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">!!$       END SELECT</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">!!$    CLOSE(14)</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">IF</span>(myid.EQ.0) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: Finished Reading Solids Mesh&#39;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">IF</span>(.NOT.(glb%DebondPart).AND. .NOT.(glb%DebondPart_Matous) )<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;       <span class="keywordflow">IF</span> ( glb%NumMatOrtho == 0 ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%E11o(1:0))</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%E22o(1:0))</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%E33o(1:0))</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%xnu12o(1:0))</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%xnu13o(1:0))</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%xnu23o(1:0))</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%G12o(1:0))</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%G13o(1:0))</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%G23o(1:0))</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vx1o(1:0))</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vy1o(1:0))</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vz1o(1:0))</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vx2o(1:0))</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vy2o(1:0))</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vz2o(1:0))</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vx3o(1:0))</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vy3o(1:0))</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%vz3o(1:0))</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;       <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;       CALL <a class="code" href="vol__elem__mat_8f90.html#a6d64aa02f525927bf36ac250b83afbb0">vol_elem_mat</a>(glb%E,glb%xnu,glb%ci,glb%cj,glb%NumMatVol,glb%iElIntgratn,glb%MatOrtho)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;       CALL <a class="code" href="vol__elem__mat__ortho_8f90.html#a1be6b83b96ffea4226a4faaa4d34e585">vol_elem_mat_ortho</a>( glb%ci_full, glb%ci, glb%NumMatVol, glb%NumMatOrtho, glb%MatOrtho, &amp;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;             glb%E11o, glb%E22o, glb%E33o, glb%xnu12o, glb%xnu13o, glb%xnu23o, &amp;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;             glb%G12o, glb%G13o, glb%G23o, glb%vx1o, glb%vy1o, glb%vz1o, &amp;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;             glb%vx2o, glb%vy2o, glb%vz2o, glb%vx3o, glb%vy3o, glb%vz3o )</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%DebondPart_Matous)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;       <span class="keyword">ALLOCATE</span>( glb%StrainOld(1:4,1:glb%NumElVol*6) ) </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;       <span class="keyword">ALLOCATE</span>( glb%SoftParam(1:4,1:glb%NumElVol) ) </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;       <span class="keyword">ALLOCATE</span>( glb%cd(1:4,1:glb%NumElVol) )</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;       CALL <a class="code" href="vol__elem__mat__matous_8f90.html#a965d115f5235ae32c90f9ae08a0a6f60">vol_elem_mat_matous</a>(glb)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%DebondPart)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%STATEV_Part1(1:glb%NumElVol))</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%STATEV_Part2(1:glb%NumElVol))</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;       glb%STATEV_Part1(:) = 1</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;       glb%STATEV_Part2(:) = 1</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%StrainTrace(1:glb%NumElVol))</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">IF</span>(glb%iElType.EQ.8)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;       <span class="keyword">allocate</span>(glb%mixed_map(1:8,1:9,1:12))</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;       <span class="keyword">allocate</span>(glb%enhanced_map(1:8,1:9,1:9))</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;       <span class="keyword">allocate</span>(glb%Aenh(1:9,1:glb%NumElVol))</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;       glb%mixed_map = 0.d0</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;       glb%enhanced_map = 0.d0</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;       glb%Aenh(:,:) = 0.d0</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;       CALL <a class="code" href="enhanced__elem__maps__hex_8f90.html#afc29040442235f1bf58aeaecae6b97fd">enhanced_elem_maps_hex</a>(glb%mixed_map,glb%enhanced_map)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;       <span class="comment">! ... If thermal solver, dmat is NumMatVol x 3 x 3.</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;       <span class="keywordflow">IF</span> (glb%HeatTransSoln) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          <span class="keyword">allocate</span>(glb%dmat(1:glb%NumMatVol,1:3,1:3))</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;          CALL <a class="code" href="ConductivityTensor_8f90.html#a62e3a615b4f9b50e3a3dd261fdd31c51">conductivitytensor</a>(glb%NumMatVol,glb%KappaHT,glb%dmat)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;          <span class="keyword">allocate</span>(glb%dmat(1:glb%NumMatVol,1:9,1:9))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;          </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumMatVol</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;             CALL <a class="code" href="get__mat__stiffness_8f90.html#a5e45c37f6915d6ba6d11a22ee8bfc354">get_mat_stiffness</a>(glb%E(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%xnu(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),glb%dmat(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,:,:))</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">!-----Setting initial conditions</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%Disp(1:3*glb%NumNP))</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    glb%Disp(:)  = 0.d0</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%Accel(1:3*glb%NumNP))</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    glb%Accel(:) = 0.d0</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%DispOld(1:3*glb%NumNP))</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%S11(1:glb%iStrGss,1:glb%NumElVol),glb%S22(1:glb%iStrGss,1:glb%NumElVol))</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%S33(1:glb%iStrGss,1:glb%NumElVol) )</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%S12(1:glb%iStrGss,1:glb%NumElVol),glb%S23(1:glb%iStrGss,1:glb%NumElVol))</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%S13(1:glb%iStrGss,1:glb%NumElVol) )</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%SVonMises(1:glb%NumElVol))</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">IF</span>(glb%HeatTransSoln)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%Temperature(1:glb%NumNP))</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;       glb%Temperature(1:glb%NumNP) = glb%Temperature0</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">IF</span>(glb%ArtificialDamping)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%DetF_Old(1:glb%iStrGss,1:glb%NumElVol))</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;       glb%DetF_Old(:,:) = 1.d0</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">endif</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">! new: ale formulation</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%DispBar(1:3*glb%NumNP),glb%VeloBar(1:3*glb%NumNP),glb%AccelBar(1:3*glb%NumNP))</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    glb%DispBar(:) = 0.d0</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    glb%VeloBar(:) = 0.d0</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    glb%AccelBar(:) = 0.d0</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%VeloHalf(1:3*glb%NumNP),glb%VeloBarOld(1:3*glb%NumNP))</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    glb%VeloHalf(:) = 0.d0</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    glb%VeloBarOld(:) = 0.d0</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keyword">ALLOCATE</span>(glb%DispTotal(1:3*glb%NumNP))</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    glb%S11(1:glb%iStrGss,1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    glb%S22(1:glb%iStrGss,1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    glb%S33(1:glb%iStrGss,1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    glb%S12(1:glb%iStrGss,1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    glb%S23(1:glb%iStrGss,1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    glb%S13(1:glb%iStrGss,1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    glb%SVonMises(1:glb%NumElVol) = 0.d0</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    glb%Accel = 0.d0</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    glb%VeloBar = 0.d0</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">!    glb%AccelBndry = 0.d0 ! not zero for restart.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">!    glb%VeloBndry = 0.d0 ! not zero for restart.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    glb%DispBar = 0.d0</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    glb%DispTotal = 0.d0</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">! Create window for HDF output</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.disp&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>, com_double, 3, <span class="stringliteral">&#39;m&#39;</span>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.disp_burn&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>,com_double, 3, <span class="stringliteral">&#39;m&#39;</span>)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.velo&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>, com_double, 3, <span class="stringliteral">&#39;m/s&#39;</span>)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.stress&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, 1, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.accel&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>, com_double, 3, <span class="stringliteral">&#39;m/s^2&#39;</span>)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.vbar&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>, com_double, 3, <span class="stringliteral">&#39;m/s&#39;</span>)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.S11&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, glb%iStrGss, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.S22&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, glb%iStrGss, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.S33&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, glb%iStrGss, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.S12&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, glb%iStrGss, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.S23&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, glb%iStrGss, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.S13&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, glb%iStrGss, <span class="stringliteral">&#39;Pa&#39;</span>)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.NumElPartBndry&#39;</span>, <span class="stringliteral">&#39;p&#39;</span>, com_integer, 1, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.NumElVolMat&#39;</span>, <span class="stringliteral">&#39;p&#39;</span>, com_integer, 1, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.NumElPartBndryMat&#39;</span>, <span class="stringliteral">&#39;p&#39;</span>, com_integer, 1, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">IF</span>(glb%DebondPart)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;       CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.StrainTrace&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, 1, <span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;       CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.DebondLg&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, 1, <span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;       CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.DebondSm&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, 1, <span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">IF</span>(glb%DebondPart_Matous)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;       CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.StrainOld&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, 4, <span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;       CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.SoftParam&#39;</span>, <span class="stringliteral">&#39;e&#39;</span>, com_double, 4, <span class="stringliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">IF</span>(glb%HeatTransSoln) CALL com_new_attribute( volwin//<span class="stringliteral">&#39;.Temp&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>, com_double, 1, <span class="stringliteral">&#39;K&#39;</span>)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">IF</span> ( glb%NumNP &gt; 0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">! Registering Coordinates</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">!!$    CALL COM_init_mesh( volWin//&#39;.nc&#39;, MyId+1, glb%MeshCoor, glb%NumNP)</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;       CALL com_set_array(volwin//<span class="stringliteral">&#39;.nc&#39;</span>, myid+1, glb%MeshCoor,3)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">! Registering Element Connectivity</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;       <span class="keywordflow">IF</span>(glb%iElType.EQ.4)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">!!$       CALL COM_init_mesh( volWin//&#39;.T4&#39;, MyId+1, glb%ElConnVol, glb%NumElVol)</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          CALL com_set_array( volwin//<span class="stringliteral">&#39;.:T4&#39;</span>, myid+1,  glb%ElConnVol,4)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;       <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%iElType.EQ.10)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">!!$       CALL COM_init_mesh( volWin//&#39;.T10&#39;, MyId+1, glb%ElConnVol, glb%NumElVol)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          CALL com_set_array( volwin//<span class="stringliteral">&#39;.:T10&#39;</span>, myid+1,  glb%ElConnVol,10)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;       <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%iElType.EQ.8)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">!!$       CALL COM_init_mesh( volWin//&#39;.H8&#39;, MyId+1, glb%ElConnVol, glb%NumElVol)</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;          CALL com_set_array( volwin//<span class="stringliteral">&#39;.:H8&#39;</span>, myid+1,  glb%ElConnVol,8)</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;       </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.disp&#39;</span>, myid+1, glb%Disp,3) <span class="comment">! was DispTotal</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.disp_burn&#39;</span>, myid+1, glb%DispBar,3)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.velo&#39;</span>, myid+1, glb%VeloHalf,3)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.stress&#39;</span>, myid+1, glb%SVonMises,1)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.accel&#39;</span>, myid+1, glb%Accel,3)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.vbar&#39;</span>, myid+1, glb%VeloBar,3)</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.S11&#39;</span>, myid+1, glb%S11)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.S22&#39;</span>, myid+1, glb%S22)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.S33&#39;</span>, myid+1, glb%S33)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.S12&#39;</span>, myid+1, glb%S12)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.S23&#39;</span>, myid+1, glb%S23)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.S13&#39;</span>, myid+1, glb%S13)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;       CALL com_set_size( volwin//<span class="stringliteral">&#39;.NumElPartBndry&#39;</span>, myid+1, 1)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.NumElPartBndry&#39;</span>, myid+1,glb%NumElPartBndry,1 )</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;       CALL com_set_size( volwin//<span class="stringliteral">&#39;.NumElVolMat&#39;</span>, myid+1, glb%NumMatVol)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.NumElVolMat&#39;</span>, myid+1, glb%NumElVolMat, 1)</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;       </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;       CALL com_set_size( volwin//<span class="stringliteral">&#39;.NumElPartBndryMat&#39;</span>, myid+1, glb%NumMatVol)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;       CALL com_set_array( volwin//<span class="stringliteral">&#39;.NumElPartBndryMat&#39;</span>,myid+1, glb%NumElPartBndryMat, 1 )</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;       <span class="keywordflow">IF</span>(glb%HeatTransSoln) CALL com_set_array( volwin//<span class="stringliteral">&#39;.Temp&#39;</span>, myid+1, glb%Temperature,1)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;       <span class="keywordflow">IF</span>(glb%DebondPart) CALL com_set_array( volwin//<span class="stringliteral">&#39;.DebondLg&#39;</span>, myid+1, glb%STATEV_Part1,1)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;       <span class="keywordflow">IF</span>(glb%DebondPart) CALL com_set_array( volwin//<span class="stringliteral">&#39;.DebondSm&#39;</span>, myid+1, glb%STATEV_Part2,1)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;       <span class="keywordflow">IF</span>(glb%DebondPart) CALL com_set_array( volwin//<span class="stringliteral">&#39;.StrainTrace&#39;</span>, myid+1, glb%StrainTrace,1)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;       <span class="keywordflow">IF</span>(glb%DebondPart_Matous) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          CALL com_set_array( volwin//<span class="stringliteral">&#39;.StrainOld&#39;</span>, myid+1, glb%StrainOld,4)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;          CALL com_set_array( volwin//<span class="stringliteral">&#39;.SoftParam&#39;</span>, myid+1, glb%SoftParam,4)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">IF</span>(initialtime.NE.0.d0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;       <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: RESTARTING, SOLIDS&#39;</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;       glb%ReStart = .true.</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   CALL com_new_attribute(volwin//<span class="stringliteral">&#39;.BCValue&#39;</span>,<span class="stringliteral">&#39;p&#39;</span>,com_double, 1, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   CALL com_set_size( volwin//<span class="stringliteral">&#39;.BCValue&#39;</span>, myid+1, glb%NumNdsBCcrypt*6)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   CALL com_set_array( volwin//<span class="stringliteral">&#39;.BCValue&#39;</span>, myid+1, glb%BCValueGlb, 1)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   CALL com_new_attribute(volwin//<span class="stringliteral">&#39;.bcnode&#39;</span>,<span class="stringliteral">&#39;p&#39;</span>,com_integer, 2, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   CALL com_set_size( volwin//<span class="stringliteral">&#39;.bcnode&#39;</span>, myid+1, glb%NumNdsBCcrypt)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   CALL com_set_array( volwin//<span class="stringliteral">&#39;.bcnode&#39;</span>, myid+1, glb%BCFlagCrypt, 2)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   CALL com_new_attribute(volwin//<span class="stringliteral">&#39;.MatType&#39;</span>,<span class="stringliteral">&#39;e&#39;</span>,com_integer, 1, <span class="stringliteral">&#39;&#39;</span>)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   CALL com_set_array( volwin//<span class="stringliteral">&#39;.MatType&#39;</span>, myid+1, glb%MatIdVol, 1)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   glb%NumNdsBC   = 0</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   glb%NumNdsBCmm = 0</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   glb%NumNdsBCHT = 0   </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   CALL com_window_init_done( volwin)</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   CALL com_call_function( obtain_attr, 2, &amp;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        com_get_attribute_handle_const( volin//<span class="stringliteral">&quot;.all&quot;</span>), &amp;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        com_get_attribute_handle( volwin//<span class="stringliteral">&quot;.all&quot;</span>))</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   glb%TotNumNeighProcs = 0</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">! -- Read lst nodes that need to be sent to other processors</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">!!$   iptr = 1</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">!!$   DO</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">!!$      IF(iptr.GT.NumParComm)EXIT</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">!!$      glb%TotNumNeighProcs = glb%TotNumNeighProcs + 1</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">!!$      iptr = iptr + ParComm( iptr + 1) + 2</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">!!$   ENDDO</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment">! crashes on copper if no if statement</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">IF</span>(numprocs.GT.1) glb%TotNumNeighProcs = parcomm(1)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">!          IF(glb%TotNumNeighProcs.NE.0)THEN</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%NeighProcList(1:glb%TotNumNeighProcs))</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">!          ENDIF</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;     </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%NumNdComm(1:glb%TotNumNeighProcs))</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <span class="keyword">ALLOCATE</span>(glb%NdCommList(1:glb%TotNumNeighProcs))</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   glb%TotNumNdComm = 0</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">! NOTE: NeighProcList is the actual processor starting at id = 0, not 1</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   iptr = 1</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%TotNumNeighProcs</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      iptr = iptr + 1</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      glb%NeighProcList(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = parcomm(iptr) -1</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      iptr = iptr + 1</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      glb%NumNdComm(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = parcomm(iptr)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      glb%TotNumNdComm = glb%TotNumNdComm + glb%NumNdComm(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;             </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keyword">ALLOCATE</span>(glb%NdCommList(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)%NdId(1:glb%NumNdComm(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)))</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>=1,glb%NumNdComm(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;         iptr = iptr + 1</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;         glb%NdCommList(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)%NdId(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) = parcomm(iptr)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;   <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   glb%TotNumNdComm = glb%TotNumNdComm*3 <span class="comment">! x3 (x,y,z R_in)</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">IF</span>(glb%TotNumNeighProcs.NE.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%RecvDataFrm(1:numprocs) )</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%ReqRcv     (1:glb%TotNumNeighProcs)  )</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%ReqSnd     (1:glb%TotNumNeighProcs)  )</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;       </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%StatSnd  (1:mpi_status_size,1:glb%TotNumNeighProcs)  )</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;       <span class="keyword">ALLOCATE</span>(glb%StatRcv  (1:mpi_status_size,1:glb%TotNumNeighProcs)  )</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">IF</span>(glb%HeatTransSoln)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;       <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%TotNumNeighProcs</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;          <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = glb%NeighProcList(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) + 1</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%RecvDataFrm(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)%rcvbuf(1:glb%NumNdComm(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)*4))</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;       <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;       <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%TotNumNeighProcs</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = glb%NeighProcList(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) + 1</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;          <span class="keyword">ALLOCATE</span>(glb%RecvDataFrm(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)%rcvbuf(1:glb%NumNdComm(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)*3))</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;       <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumNdsBCcrypt</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      ndbcflag = mod(glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),100)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">! structural boundary conditions</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">IF</span>(ndbcflag.GT.0) glb%NumNdsBC = glb%NumNdsBC + 1</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      ndbcflag = glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)/10000</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">! mesh motion boundary conditions</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">IF</span>(ndbcflag.GT.0) glb%NumNdsBCmm = glb%NumNdsBCmm  + 1</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      ndbcflag = mod(glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),10000)/100</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">! thermal boundary conditions</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">IF</span>(ndbcflag.GT.0) glb%NumNdsBCHT = glb%NumNdsBCHT + 1</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   <span class="keywordflow">IF</span>(glb%NumNdsBC.NE.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keyword">ALLOCATE</span>(glb%BCFlag(1:4,1:glb%NumNdsBC),glb%BCvalue(1:3,1:glb%NumNdsBC))</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keyword">ALLOCATE</span>(glb%AccelBndry(1:3*glb%NumNdsBC),glb%VeloBndry(1:3*glb%NumNdsBC))</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   <span class="keywordflow">IF</span>(glb%NumNdsBCmm.NE.0) <span class="keyword">ALLOCATE</span>(glb%BCFlagmm(1:4,1:glb%NumNdsBCmm),glb%BCvaluemm(1:3,1:glb%NumNdsBCmm))</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;   <span class="keywordflow">IF</span>(glb%NumNdsBCHT.NE.0) <span class="keyword">ALLOCATE</span>(glb%BCFlagHT(1:2,1:glb%NumNdsBCHT),glb%BCvalueHT(1,1:glb%NumNdsBCHT))</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   icnt1 = 0</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   icnt2 = 0</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   icnt3 = 0</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   icnt4 = 1</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;   </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">!!$   IF ( glb%NumNdsBC &gt; 0) THEN ! boundary conditions</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">!!$      CALL COM_new_attribute( volWin//&#39;.velobndry&#39;, &#39;p&#39;, COM_DOUBLE, 3, &#39;m/s&#39;)</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">!!$      CALL COM_new_attribute( volWin//&#39;.accbndry&#39;, &#39;p&#39;, COM_DOUBLE, 3, &#39;m/s^2&#39;)</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">!!$      </span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">!!$      CALL COM_set_size( volWin//&#39;.velobndry&#39;, MyId+1, glb%NumNdsBC  )</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">!!$      CALL COM_set_array( volWin//&#39;.velobndry&#39;, MyId+1, glb%VeloBndry, 3)</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">!!$      </span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">!!$      CALL COM_set_size( volWin//&#39;.accbndry&#39;, MyId+1, glb%NumNdsBC  )</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">!!$      CALL COM_set_array( volWin//&#39;.accbndry&#39;, MyId+1, glb%AccelBndry, 3)</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">!!$      </span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">!!$   ENDIF   </span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumNdsBCcrypt</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      ndbcflag = mod(glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),100)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">! structural boundary conditions</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="keywordflow">IF</span>(ndbcflag.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;         icnt1 = icnt1 + 1</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;         glb%BCFlag(1,icnt1) = glb%BCFlagCrypt(1,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;         glb%BCFlag(2,icnt1) = glb%bcCond(ndbcflag)%BCtypeX</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;         glb%BCFlag(3,icnt1) = glb%bcCond(ndbcflag)%BCtypeY</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;         glb%BCFlag(4,icnt1) = glb%bcCond(ndbcflag)%BCtypeZ</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;         glb%BCvalue(1,icnt1) = glb%bcCond(ndbcflag)%BCvalueX</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;         glb%BCvalue(2,icnt1) = glb%bcCond(ndbcflag)%BCvalueY</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;         glb%BCvalue(3,icnt1) = glb%bcCond(ndbcflag)%BCvalueZ</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;         </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;         glb%AccelBndry(icnt1*3-2:icnt1*3) = glb%BCValueGlb(icnt4:icnt4+2)</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;         icnt4 = icnt4 + 3</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;         glb%VeloBndry(icnt1*3-2:icnt1*3) = glb%BCValueGlb(icnt4:icnt4+2)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;         icnt4 = icnt4 + 3</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;         </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      ndbcflag = glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)/10000</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">! mesh motion boundary conditions</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <span class="keywordflow">IF</span>(ndbcflag.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;         icnt2 = icnt2 + 1</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;         glb%BCFlagmm(1,icnt2) = glb%BCFlagCrypt(1,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;         glb%BCFlagmm(2,icnt2) = glb%bcCondmm(ndbcflag)%BCtypeX</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;         glb%BCFlagmm(3,icnt2) = glb%bcCondmm(ndbcflag)%BCtypeY</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;         glb%BCFlagmm(4,icnt2) = glb%bcCondmm(ndbcflag)%BCtypeZ</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;         glb%BCvaluemm(1,icnt2) = glb%bcCondmm(ndbcflag)%BCvalueX</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;         glb%BCvaluemm(2,icnt2) = glb%bcCondmm(ndbcflag)%BCvalueY</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         glb%BCvaluemm(3,icnt2) = glb%bcCondmm(ndbcflag)%BCvalueZ</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      ndbcflag = mod(glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),10000)/100</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">! thermal boundary conditions</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      <span class="keywordflow">IF</span>(ndbcflag.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;         icnt3 = icnt3 + 1</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;         glb%BCFlagHT(1,icnt3) = glb%BCFlagCrypt(1,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;         </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;         glb%BCFlagHT(2,icnt3) = glb%bcCondHT(ndbcflag)%BCtypeX</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;         glb%BCvalueHT(1,icnt3) = glb%bcCondHT(ndbcflag)%BCvalueX</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   CALL <a class="code" href="classrocfracsubinterface.html#a93c183aa2e5a67aed64b5a2f2541ac57">rocfracinterfaceinitial</a>( glb,obtain_attr,surfin)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">!!    ! ... Triangular initial temperature distribution in </span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">!!    ! ... 1-D bar validation problem. COstoich 03/18/09</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">!!    ! ... Change the direction (MeshCoor(#,i)) depending on orientation of bar</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">!!    ! ... Initialize zcoord ... </span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">!!    zcoord = -1.0</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">!!    ! ... Bar orientation (ex: 1 is in the x-dir)</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">!!    dir = 2</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">!!   IF(glb%HeatTransSoln)THEN</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">!!      DO i = 1, glb%NumNP</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">!!         if (glb%MeshCoor(dir,i) &gt; zcoord) zcoord = glb%MeshCoor(dir,i)</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">!!         print*,&#39;zcoord,i&#39;,zcoord,i,maxval(glb%MeshCoor(dir,:)),minval(glb%MeshCoor(dir,:))</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">!!         if ((zcoord - minval(glb%MeshCoor(dir,:)))&lt;=((maxval(glb%MeshCoor(dir,:))-minval(glb%MeshCoor(dir,:)))/2)) THEN</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">!!            SliceTemp =  0 + 2 * glb%Temperature0 / (maxval(glb%MeshCoor(dir,:))-minval(glb%MeshCoor(dir,:))) * (zcoord - minval(glb%MeshCoor(dir,:)))</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">!!         else</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">!!            SliceTemp =  glb%Temperature0 - 2 * glb%Temperature0 / (maxval(glb%MeshCoor(dir,:))-minval(glb%MeshCoor(dir,:))) * (zcoord - maxval(glb%MeshCoor(dir,:))/2 - minval(glb%MeshCoor(dir,:))/2)</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;           </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">!!         end if</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">!!         print*,&#39;SliceTemp&#39;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">!!         do j=1,glb%NumNP</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">!!            print*,&#39;z&#39;,glb%MeshCoor(dir,j),&#39;zcoord&#39;,zcoord</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">!!         end do</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">!!         do j = 1, glb%NumNP</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">!!            if ((glb%MeshCoor(dir,j)&lt;(zcoord+.001)).and.(glb%MeshCoor(dir,j)&gt;(zcoord-.001))) THEN</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">!!               glb%Temperature(j) = Slicetemp </span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;              </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">!!            end if</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">!!         end do</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">!!         print*,myid,glb%Temperature</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">!!         read*,j</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">!!      end DO</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">!!   ENDIF</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">!!   ! ... Smooth initial temperature distribution in </span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">!!   ! ... 1-D coupled problem. COstoich 04/02/09</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">!!    zcoord = -1.0</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">!!    dir=3</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">!!   IF(glb%HeatTransSoln)THEN</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">!!      DO i = 1, glb%NumNP</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">!!         if (glb%MeshCoor(dir,i) &gt; zcoord) zcoord = glb%MeshCoor(dir,i)</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">!! !        print*,&#39;zcoord,i&#39;,zcoord,i,maxval(glb%MeshCoor(dir,:)),minval(glb%MeshCoor(dir,:))</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">!! !        if ((zcoord - minval(glb%MeshCoor(2,:)))&lt;=((maxval(glb%MeshCoor(dir,:))-minval(glb%MeshCoor(dir,:)))/2)) THEN</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">!!            SliceTemp =  glb%Temperature0 +  (330.0-glb%Temperature0) / (maxval(glb%MeshCoor(dir,:))-minval(glb%MeshCoor(dir,:))) * (zcoord - minval(glb%MeshCoor(dir,:)))</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">!! !        else</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">!! !           SliceTemp =  glb%Temperature0 - 2 * glb%Temperature0 / (maxval(glb%MeshCoor(2,:))-minval(glb%MeshCoor(2,:))) * (zcoord - maxval(glb%MeshCoor(2,:))/2 - minval(glb%MeshCoor(2,:))/2)</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;           </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">!! !        end if</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">!! !        print*,&#39;SliceTemp&#39;</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">!!         do j=1,glb%NumNP</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">!! !           print*,&#39;z&#39;,glb%MeshCoor(dir,j),&#39;zcoord&#39;,zcoord</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">!!         end do</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">!!         do j = 1, glb%NumNP</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">!!            if ((glb%MeshCoor(dir,j)&lt;(zcoord+.001)).and.(glb%MeshCoor(dir,j)&gt;(zcoord-.001))) THEN</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">!!               glb%Temperature(j) = Slicetemp </span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;              </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">!!            end if</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">!!         end do</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">!! !        print*,glb%Temperature</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">!! !        read*,j</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">!!      end DO</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">!!   ENDIF</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">!!$   DO j = 1, glb%NumNP</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">!!$      j1 = j*3</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">!!$      glb%MeshCoor(1,j) = glb%coor(1,j) + glb%DispBar(j1 - 2)</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">!!$      glb%MeshCoor(2,j) = glb%coor(2,j) + glb%DispBar(j1 - 1)</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">!!$      glb%MeshCoor(3,j) = glb%coor(3,j) + glb%DispBar(j1    )</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">!!$   ENDDO</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   CALL <a class="code" href="classrocfracmain.html#abcb89d944827dbce26cd9199cd53c504">rocfracinterfacebuff</a>(glb)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   CALL com_call_function( man_init, 2, surwin, volwin)</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="keywordflow">IF</span>(.NOT.(glb%ALEenabled))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      CALL <a class="code" href="UpdateMassMatrix_8f90.html#ad0bd8790ced9e6375c63e6664a39dd0d">updatemassmatrix</a>(glb)</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;11 <span class="keyword">FORMAT</span>(<a class="code" href="classLine__2.html#a788c8fb7953bc03c442e6d905abe0c01">a</a>,<span class="stringliteral">&#39;_&#39;</span>,<a class="code" href="classLine__2.html#a788c8fb7953bc03c442e6d905abe0c01">a</a>,a1)</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">!!$    IF(myid.EQ.0) PRINT*,&#39;ROCFRAC :: Finished RocFracInitialize&#39;</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">!!$   CALL MPI_BARRIER(glb%MPI_COMM_ROCFRAC,ierr)</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">!!$   CALL MPI_FINALIZE(glb%MPI_COMM_ROCFRAC,ierr)</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">! -- Mass/Volume Conservation</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   glb%TotalMassSolidp = 0.d0</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;   glb%TotalGeomVolp = 0.d0</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   <span class="keywordflow">IF</span>(glb%iElType.EQ.4.OR.glb%iElType.EQ.10 .AND.(.NOT.(glb%NdBasedEl)))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      CALL <a class="code" href="v3d4__volume_8f90.html#a27225dda763a5c16405ad0b8c729ac8b">v3d4_volume</a>(glb%MeshCoor,glb%ElConnVol,glb%MatIdVol,glb%rho, &amp;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;           glb%NumNP,glb%NumElVol,glb%NumMatVol,glb%Disp,1,glb%NumElVol,&amp;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;           glb%TotalMassSolidp,glb%TotalGeomVolp,glb%TotalGeomUndefVolp, &amp;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;           glb%iElType)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <span class="keywordflow">IF</span>(glb%NumProbesNd.NE.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      CALL <a class="code" href="FindProbe_8f90.html#ae1dc3b0df1f704457bcbb9d59aff6a01">findprobe</a>(glb,myid)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;   glb%iAmpCnt = 1</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   glb%prop = 0.d0</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   glb%slope = 0.d0</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">!!$  PRINT*,&#39;sdfsdflkjsdflkj&#39;,myid</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">!!$  PRINT*,&#39;finished readsdv&#39;,myid</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">!!$  CALL MPI_BARRIER(glb%MPI_COMM_ROCFRAC,i)</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">!!$  stop</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   <span class="keyword">inquire</span>(file=<span class="stringliteral">&#39;Rocfrac/Rocin/OverlayMappings.txt&#39;</span>,exist=glb%OverlayExist)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;   <span class="keywordflow">IF</span>(glb%OverlayExist)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      CALL <a class="code" href="readsdv_8f90.html#a5ee3bef9cabac0bc871f99eb4778379d">readsdv</a>(glb,myid)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keyword">OPEN</span>(456,file =<span class="stringliteral">&#39;Rocfrac/Rocin/OverlayMappings.txt&#39;</span>)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordflow">DO</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         <span class="keyword">READ</span>(456,*,iostat=ios) iprocs </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         <span class="keywordflow">IF</span>(ios.LT.0) <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;         </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         <span class="keywordflow">IF</span>(iprocs.EQ.myid)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">!!$        READ(456,*) glb%nf1</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">!!$        ALLOCATE(MapFaceEl2Vol1a(1:600),FaceOfVolEL1a(1:600))</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">!!$        </span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">!!$        DO i = 1, glb%nf1</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">!!$           READ(456,&#39;()&#39;) </span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">!!$        ENDDO</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">!!$        </span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">!!$        READ(456,*) iaux</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">!!$        </span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">!!$        DO i = 1, iaux</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">!!$           READ(456,&#39;()&#39;)</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">!!$        ENDDO</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">!!$        PRINT*,&#39;;;&#39;,myid</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">!!$        READ(456,*) glb%nf1</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">!!$        PRINT*,glb%nf1,myid</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            <span class="keyword">READ</span>(456,*) glb%nf1</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="keyword">ALLOCATE</span>(glb%MapFaceEl2Vol1(1:glb%nf1),glb%FaceOfVolEL1(1:glb%nf1))</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%nf1</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;               <span class="keyword">READ</span>(456,*) glb%MapFaceEl2Vol1(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>), glb%FaceOfVolEL1(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keyword">READ</span>(456,*) glb%nf2</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            <span class="keyword">ALLOCATE</span>(glb%MapFaceEl2Vol2(1:glb%nf2),glb%FaceOfVolEL2(1:glb%nf2))</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%nf2</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;               <span class="keyword">READ</span>(456,*) glb%MapFaceEl2Vol2(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>), glb%FaceOfVolEL2(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">!!$        READ(456,*) iaux</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">!!$        </span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">!!$        DO i = 1, iaux</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">!!$           READ(456,&#39;()&#39;)</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">!!$        ENDDO</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">!!$        DO i = 1, glb%nf1</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">!!$           READ(456,&#39;()&#39;)</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">!!$        ENDDO</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        <span class="keywordflow">EXIT</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;     <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keyword">READ</span>(456,*) iaux</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, iaux</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;           <span class="keyword">READ</span>(456,<span class="stringliteral">&#39;()&#39;</span>) </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keyword">READ</span>(456,*) iaux</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, iaux</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;           <span class="keyword">READ</span>(456,<span class="stringliteral">&#39;()&#39;</span>)</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;     <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keyword">close</span>(456)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordflow">endif</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">!!$  IF(myid.EQ.1)THEN</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">!!$     DO i = 1, glb%nf1</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">!!$        PRINT*, i,glb%MapFaceEl2Vol1(i), glb%FaceOfVolEL1(i)</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">!!$     ENDDO</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">!!$     DO i = 1, glb%nf2</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">!!$        PRINT*,i, glb%MapFaceEl2Vol2(i), glb%FaceOfVolEL2(i)</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">!!$     ENDDO</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">!!$  ENDIF</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">!!$   do i = 1, glb%NumNp</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">!!$      IF( glb%MeshCoor(1,i).LE.1.0001.AND.glb%MeshCoor(2,i).GT.0.02499.AND.glb%MeshCoor(3,i).GT.0.02499)THEN</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">!!$         glb%NumNodeIO = i</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">!!$      ENDIF</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">!!$   enddo</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">IF</span> ( glb%IMP .eqv. .true.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;       </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;       <span class="comment">! ... For development of thermal code, must change in the future</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;       <span class="comment">! ... at present, if the thermal code is run, then the structural </span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;       <span class="comment">! ... code is not.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;       <span class="keywordflow">IF</span> ( glb%HeatTransSoln .eqv. .true.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;          CALL <a class="code" href="thermal__initialize_8f90.html#a00dc899d29f6c95a9d143a4224c8a6b1">thermal_initialize</a>(glb)</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;          CALL <a class="code" href="implicit__initialize_8f90.html#afd4645439bc0ee9bb11e74c6f1e31832">implicit_initialize</a>(glb)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;       <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;   </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="keyword"> END SUBROUTINE </span><a class="code" href="classrocfracmain.html#a528eefffb0ac5281d70ae23fb12b9350">rocfracinitialize</a></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">! ----------------------------------------------------------------------- RocFracFinalize</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div>
<div class="line"><a name="l01236"></a><span class="lineno"><a class="line" href="classrocfracmain.html#a12ffc754c70faa0a4631198391f72205"> 1236</a></span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="classrocfracmain.html#a12ffc754c70faa0a4631198391f72205">rocfracfinalize</a>( glb)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordtype">USE </span><a class="code" href="classimplicit__global.html">implicit_global</a></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    include <span class="stringliteral">&#39;roccomf90.h&#39;</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;     </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordtype">TYPE(</span><a class="code" href="structrocstar__rocfrac_1_1rocfrac__global.html">rocfrac_global</a><span class="keywordtype">)</span>, <span class="keywordtype">POINTER</span> :: glb</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    CALL com_delete_window( surwin)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    CALL com_delete_window( volwin)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">IF</span> ( glb%IMP ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;       <span class="keywordflow">IF</span>(glb%HeatTransSoln .EQV. .true.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          CALL <a class="code" href="thermal__finalize_8f90.html#afc757ca8f4817bfc0821efcf39c0cab0">thermal_finalize</a>(glb)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;          CALL <a class="code" href="implicit__finalize_8f90.html#a3695ac9fa4767e80d533c5bbf191cb98">implicit_finalize</a>(glb)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;       <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="classrocfracmain.html#a12ffc754c70faa0a4631198391f72205">rocfracfinalize</a></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">! ----------------------------------------------------------------------- RocFracSoln</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"><a class="line" href="classrocfracmain.html#af8df50c77956c23e6df0da51df12145d"> 1265</a></span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="classrocfracmain.html#af8df50c77956c23e6df0da51df12145d">rocfracsoln</a>( glb, CurrentTime, CurrentTimeStep, MAN_update_inbuff)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    include <span class="stringliteral">&#39;mpif.h&#39;</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordtype">TYPE(</span><a class="code" href="structrocstar__rocfrac_1_1rocfrac__global.html">rocfrac_global</a><span class="keywordtype">)</span>, <span class="keywordtype">POINTER</span> :: glb</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">INTENT(IN)</span>            :: currenttime, currenttimestep</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span>           :: man_update_inbuff</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span>:: istep</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordtype">INTEGER</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>,jj,jjj,<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>,k1,k2,j1,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,j2,j3,k3,k4 <span class="comment">! loop counters &amp; dummy variables</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">INTEGER</span> :: ntime_out   <span class="comment">! processor&#39;s id ( 0-(nprocs-1) )</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">!--   First section Rnet = R_bar</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">!--   Force Sum: cohesive traction + (-internal) + (-damping)+ external </span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">!--   i.e. R_co - R_in - R_damp + R_ex</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: rnet</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: rnetht</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">!--   reciprical of mass matrix diagonal</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordtype">REAL*8</span> :: tvol, tvol_com</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">DIMENSION(2)</span> :: trry_dt,trry_vol,trry_calc,trry_dv_com</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">DIMENSION(2)</span> :: trry_energy,trry_io,trry_coh,trry_vol_com</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">ALLOCATABLE</span>, <span class="keywordtype">DIMENSION(:)</span> :: buf</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">! Dummy variable</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordtype">REAL*8</span> :: a1</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordtype">CHARACTER*8</span> :: ichr8   <span class="comment">! output file number (a character)</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordtype">CHARACTER*3</span> :: ai,ai1  <span class="comment">! output file number (a character)</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="keywordtype">INTEGER</span> :: myid, ierr  <span class="comment">! mpi error variable</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordtype">INTEGER</span> :: isubstep,nsubstep</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordtype">REAL*8</span> :: dt_solid_sub, <a class="code" href="classColor.html#af94d15b3f5e32b9137fc219dcb16bd53">alpha</a></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordtype">REAL*8</span> :: currenttimestepsolid</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordtype">REAL*8</span> :: prin1, prin2, prin3</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span> :: ifirststep</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordtype">REAL*8</span> :: maxvalue</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordtype">INTEGER</span> :: maxlocat</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordtype">INTEGER</span> :: jaux</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordtype">INTEGER</span> :: elemstart, elemend, numprocs</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordtype">REAL*8</span> :: dispprev</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordtype">INTEGER</span> :: ndbcflag, icnt1, icnt5</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordtype">logical</span> :: <a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordtype">CHARACTER*4</span> :: ichr1, ichr2</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordtype">REAL*8</span> :: tempf1, tempf2</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">! _____________________________</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">! _____ SOLUTION LOOP</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">! _____________________________</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;         </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    CALL mpi_comm_rank(glb%MPI_COMM_ROCFRAC,myid,ierr)    </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    CALL mpi_comm_size(glb%MPI_COMM_ROCFRAC,numprocs,ierr)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a> = glb%debug_state</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    tvol = 0.d0; tvol_com = 0.d0</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    nsubstep = 1</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    currenttimestepsolid = currenttimestep</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    ifirststep = 0</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    glb%DispOld(:) = glb%Disp(:)</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keyword">ALLOCATE</span>(rnet(1:3*glb%NumNP))</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">IF</span>(glb%HeatTransSoln) <span class="keyword">ALLOCATE</span>(rnetht(1:glb%NumNP))</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <span class="keywordflow">IF</span>(myid.EQ.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;       <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac ::  Time Step             Dt&#39;</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;       <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: -------------------------&#39;</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    glb%CurrTime = currenttime</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">!    open(3001,file=&#39;ndhistory&#39;)</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;   </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">DO</span> <span class="keywordflow">WHILE</span> (nsubstep.EQ.1)</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;       CALL <a class="code" href="max__dt__solid_8f90.html#a3fdf1ef4d6b59c269d39c74d56a38b62">max_dt_solid</a>(dt_solid_sub,glb)</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;       <span class="keywordflow">IF</span>(dt_solid_sub.GE.currenttimestepsolid)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          nsubstep = 0</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;          glb%DT = currenttimestepsolid</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;          currenttimestepsolid = 0</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          nsubstep = 1</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          glb%DT = dt_solid_sub</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;          currenttimestepsolid = currenttimestepsolid - glb%DT</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;       glb%DTInv = 1.d0 / glb%DT</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;       istep = istep + 1</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;       <span class="comment">! Compute alpha here</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;       <a class="code" href="classColor.html#af94d15b3f5e32b9137fc219dcb16bd53">alpha</a> = 1.d0 - currenttimestepsolid / currenttimestep</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;       CALL com_call_function( man_update_inbuff, 1, <a class="code" href="classColor.html#af94d15b3f5e32b9137fc219dcb16bd53">alpha</a>)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;       glb%CurrTime = currenttime + (currenttimestep-currenttimestepsolid)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;       <span class="keywordflow">IF</span>(myid.EQ.0) <span class="keyword">WRITE</span>(*,<span class="stringliteral">&#39;(a10,i10,4e12.4)&#39;</span>)<span class="stringliteral">&#39;RocFrac ::&#39;</span>, istep, &amp;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            (currenttimestep-currenttimestepsolid), glb%DT,currenttimestep,glb%CurrTime</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;       <span class="comment">!-- (0) INITIALIZE</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;       ntime_out = 0</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;       rnet(:) = 0.d0</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;       <span class="keywordflow">IF</span>(glb%HeatTransSoln) rnetht(:) = 0.d0</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;       <span class="keywordflow">IF</span>( glb%AmplitudeTable )<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          <span class="keywordflow">IF</span>(glb%iAmpCnt.LE.glb%NumEntries-1)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;             <span class="keywordflow">IF</span>(glb%CurrTime.GT.glb%AmpTable(1,glb%iAmpCnt+1))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                glb%iAmpCnt = glb%iAmpCnt + 1</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          glb%slope = glb%AmpTable(2,glb%iAmpCnt)</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;          glb%prop = glb%CurrTime*glb%AmpTable(2,glb%iAmpCnt) + glb%AmpTable(3,glb%iAmpCnt)</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;       <span class="keywordflow">IF</span>(glb%ALEenabled)<span class="keywordflow">THEN</span>  </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          <span class="comment">! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%InterfaceSFNumNodes</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;             k3 = 3*glb%MapNodeSF(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;             k2 = k3 - 1</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;             k1 = k3 - 2</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;             glb%VeloBar(k1) = glb%InterfaceSFVbar(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;             glb%VeloBar(k2) = glb%InterfaceSFVbar(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;             glb%VeloBar(k3) = glb%InterfaceSFVbar(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          <span class="comment">!-- (2) update mesh displacement vector (ale)</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          glb%DispBar(:) = glb%DT*glb%VeloBar(:)   + glb%DispBar(:)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <span class="comment">!-- (3) UPDATE MESH POSITION</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%NumNP</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;             j1 = <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>*3</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;             glb%MeshCoor(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) = glb%Meshcoor(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) + glb%DT*glb%VeloBar(j1 - 2)</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;             glb%MeshCoor(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) = glb%Meshcoor(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) + glb%DT*glb%VeloBar(j1 - 1)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;             glb%MeshCoor(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) = glb%Meshcoor(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) + glb%DT*glb%VeloBar(j1    )</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          CALL <a class="code" href="UpdateMassMatrix_8f90.html#ad0bd8790ced9e6375c63e6664a39dd0d">updatemassmatrix</a>(glb)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          <span class="comment">!-- (5) CALCULATE R_BAR</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;          CALL <a class="code" href="UpdateR__bar_8f90.html#adf00980ee61327d18a964c71d855daea">updaterbar</a>(glb,rnet)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;          <span class="comment">!-- (6) CALCULATE MESH VELOCITY VECTOR</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%NumNP</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;             jaux = 3*<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;             <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = jaux-2, jaux</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                glb%VeloBarOld(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) = glb%VeloBar(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                glb%VeloBar(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) = glb%xmass(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)*glb%rho(1)*(-rnet(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>))*glb%kappa <span class="comment">! move - to subroutine</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;             <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;          <span class="comment">!---(7) CALCULATE R_CO</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;          <span class="comment">!     ! fix for parallel to do boundary then inside</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;          <span class="comment">!      if(numco .gt. 0) then     ! change idpressload bounds to 1:2</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;          <span class="comment">!         call CST_COH(glb%MeshCoor,lmc,matc,Rnet,d,deltan,deltat,</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;          <span class="comment">!     $        sigmax,taumax,glb%Sinit,Sthresh_cst,istep,glb%NumNP,numco,</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;          <span class="comment">!     $        numat_coh,delta,numploadelem,idpressload, pressload,</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;          <span class="comment">!     $        glb%NumNdsBCmesh, idmesh, rmesh, nboundtype, num_fail_coh, </span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;          <span class="comment">!     $        index_fail_coh, npress, nmesh, ielem_coh, iface_coh)</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;          <span class="comment">!      endif</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;          <span class="comment">!-- (8) Enforce Fixed BC&#39;s of Mesh for other boundaries not in contact with fluids</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment">!!$         DO j = 1, glb%NumNdsBCmm</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">!!$            k3 = glb%BCFlagmm(1,j)*3</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment">!!$            k2 = k3-1 </span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment">!!$            k1 = k3-2</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">!!$            IF(glb%BCFlagmm(2,j).eq.0) glb%VeloBar(k1) = 0.d0 ! rmesh(1,j)*meshvelo</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment">!!$            IF(glb%BCFlagmm(3,j).eq.0) glb%VeloBar(k2) = 0.d0 ! rmesh(2,j)*meshvelo</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment">!!$            IF(glb%BCFlagmm(4,j).eq.0) glb%VeloBar(k3) = 0.d0 ! rmesh(3,j)*meshvelo</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">!!$         ENDDO</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;          <span class="comment">! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%InterfaceSNumNodes</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;             k3 = 3*glb%MapNodeS(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;             k2 = k3 - 1</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;             k1 = k3 - 2</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;             glb%VeloBar(k1) = glb%InterfaceSVbar(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;             glb%VeloBar(k2) = glb%InterfaceSVbar(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;             glb%VeloBar(k3) = glb%InterfaceSVbar(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;             <span class="keywordflow">IF</span>(glb%InterfaceSVbar(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>).NE.0.d0) glb%VeloBar(k1) = glb%InterfaceSVbar(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;             <span class="keywordflow">IF</span>(glb%InterfaceSVbar(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>).NE.0.d0) glb%VeloBar(k2) = glb%InterfaceSVbar(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;             <span class="keywordflow">IF</span>(glb%InterfaceSVbar(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>).NE.0.d0) glb%VeloBar(k3) = glb%InterfaceSVbar(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;          <span class="comment">! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%InterfaceSFNumNodes</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;             k3 = 3*glb%MapNodeSF(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;             k2 = k3 - 1</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;             k1 = k3 - 2</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;             glb%VeloBar(k1) = glb%InterfaceSFVbar(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;             glb%VeloBar(k2) = glb%InterfaceSFVbar(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;             glb%VeloBar(k3) = glb%InterfaceSFVbar(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;             <span class="comment">!             IF(glb%InterfaceSFVbar(1,j).NE.0.d0) glb%VeloBar(k1) = glb%InterfaceSFVbar(1,j)</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;             <span class="comment">!             IF(glb%InterfaceSFVbar(2,j).NE.0.d0) glb%VeloBar(k2) = glb%InterfaceSFVbar(2,j)</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;             <span class="comment">!             IF(glb%InterfaceSFVbar(3,j).NE.0.d0) glb%VeloBar(k3) = glb%InterfaceSFVbar(3,j) </span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;          <span class="comment">! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">!!$          DO j = 1, glb%InterfaceSNumNodes</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">!!$             k3 = 3*glb%MapNodeS(j)</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">!!$             k2 = k3 - 1</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">!!$             k1 = k3 - 2</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">!!$             glb%VeloBar(k1) = glb%InterfaceSVbar(1,j)</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">!!$             glb%VeloBar(k2) = glb%InterfaceSVbar(2,j)</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">!!$             glb%VeloBar(k3) = glb%InterfaceSVbar(3,j)</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">!!$!             IF(glb%InterfaceSVbar(1,j).NE.0.d0) glb%VeloBar(k1) = glb%InterfaceSVbar(1,j)</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">!!$!             IF(glb%InterfaceSVbar(2,j).NE.0.d0) glb%VeloBar(k2) = glb%InterfaceSVbar(2,j)</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">!!$!             IF(glb%InterfaceSVbar(3,j).NE.0.d0) glb%VeloBar(k3) = glb%InterfaceSVbar(3,j)  </span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">!!$          ENDDO</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;          <span class="comment">! Used for mass conservation</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">!!$          DO j = 1, glb%InterfaceSFNumNodes</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">!!$             k3 = 3*glb%MapNodeSF(j)</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">!!$             k2 = k3 - 1</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">!!$             k1 = k3 - 2</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">!!$             glb%VeloBar(k1) = 0.d0</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">!!$             glb%VeloBar(k2) = 0.d0</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">!!$             glb%VeloBar(k3) = 1.d0</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">!!$          ENDDO</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%NumNdsBCmm</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;             k3 = glb%BCFlagmm(1,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)*3</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;             k2 = k3-1 </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;             k1 = k3-2</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;             <span class="keywordflow">IF</span>(glb%BCFlagmm(2,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>).EQ.0) glb%VeloBar(k1) = 0.d0 <span class="comment">! rmesh(1,j)*meshvelo</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;             <span class="keywordflow">IF</span>(glb%BCFlagmm(3,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>).EQ.0) glb%VeloBar(k2) = 0.d0 <span class="comment">! rmesh(2,j)*meshvelo</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;             <span class="keywordflow">IF</span>(glb%BCFlagmm(4,<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>).EQ.0) glb%VeloBar(k3) = 0.d0 <span class="comment">! rmesh(3,j)*meshvelo</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;          rnet(:) = 0.d0</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;          <span class="comment">! -- Calculate mesh acceleration</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;          glb%AccelBar(:) = ( glb%VeloBar(:) - glb%VeloBarOld(:) ) * glb%DTInv</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;          <span class="keywordflow">IF</span>(glb%iElType.EQ.4)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;             CALL <a class="code" href="v3d4__ale_8f90.html#a44858f7fcdde70ad6b1db53113fafb6f">v3d4_ale</a>(glb%VeloBar,glb%AccelBar,glb%Disp,glb%VeloHalf,rnet, &amp;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                  glb%E,glb%xnu,glb%rho,glb%NumNP,glb%NumMatVol, &amp;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                  glb%NumElVol,glb%MatIdVol,glb%ElConnVol,glb%MeshCoor, &amp; <span class="comment">!Fix not work for more then one material</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                  1,glb%NumElPartBndry)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(glb%iElType.EQ.10)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;             CALL <a class="code" href="v3d10__ale_8f90.html#afb50cbe2574b28eb13668800d2676fb4">v3d10_ale</a>(glb%VeloBar,glb%AccelBar,glb%Disp,glb%VeloHalf,rnet, &amp;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                  glb%E,glb%xnu,glb%rho,glb%NumNP,glb%NumMatVol,  &amp;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                  glb%NumElVol,glb%MatIdVol,glb%ElConnVol,glb%MeshCoor, &amp; <span class="comment">!Fix not work for more then one material</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                  1,glb%NumElPartBndry)</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;       <span class="keywordflow">ENDIF</span> <span class="comment">! END ALE OPTION</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;finished ale&#39;</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;       <span class="comment">! -- Transfer the Tractions Due to Fluid Pressure to the 3D Solid</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">!!$       IF(glb%DefConfig)THEN</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">!!$          CALL TractLoadDef(Rnet,glb%NumNP, &amp;</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">!!$            glb%InterfaceSFElemTract, &amp;</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">!!$            glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">!!$            glb%InterfaceSFElemConn, &amp;</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">!!$            glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp)</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">!!$       ELSE</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;       <span class="comment">!          CALL TractLoad(Rnet,glb%NumNP, &amp;</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;       <span class="comment">!               glb%InterfaceSFElemTract, &amp;</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;       <span class="comment">!               glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;       <span class="comment">!               glb%InterfaceSFElemConn, &amp;</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;       <span class="comment">!               glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor)</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">!!$       ENDIF</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;Applying Pressure Loading&#39;</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;       <span class="keywordflow">IF</span>(glb%iElType.EQ.8)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;          <span class="keywordflow">IF</span>(glb%InterfaceSFnbNumElems.GT.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;             <span class="comment">! ... For temporary thermal solver development, must change!! COstoich, 02/23/09</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;             <span class="keywordflow">IF</span> ( glb%HeatTransSoln ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                CALL <a class="code" href="HeatLoad__Hex_8f90.html#a7069c1af7cb565c5c9684f47dbde422e">heatload_hex</a>(rnetht,glb%NumNP,glb%InterfaceSFnbHeatFlux, &amp;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                     glb%InterfaceSFnbNumElems, glb%InterfaceSFnbNumNodes, &amp;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                     glb%InterfaceSFnbElemConn, &amp;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                     glb%MapNodeSFnb,glb%LwrBnd,glb%UppBnd,glb%Meshcoor)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;             <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                CALL <a class="code" href="TractLoad__Hex_8f90.html#ac16b880c9c30c0cd475bc66b823157b8">tractload_hex</a>(rnet,glb%NumNP, &amp;  <span class="comment">! Don&#39;t imposed pressure on deformed coordinates</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                     glb%InterfaceSFnbElemTract, &amp;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                     glb%InterfaceSFnbNumElems, glb%InterfaceSFnbNumNodes, &amp;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                     glb%InterfaceSFnbElemConn, &amp;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                     glb%MapNodeSFnb,glb%LwrBnd,glb%UppBnd,glb%Meshcoor)</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;          CALL <a class="code" href="FluidPressLoad_8f90.html#a772d75458cd6456de0c44f2770dad99f">fluidpressload</a>(glb%NumNP,rnet, &amp;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;               glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;               glb%InterfaceSFElemConn, &amp;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;               glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFElVolEl,&amp;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;               glb%ElConnVol,glb%iElType,glb%NumElVol,glb%InterfaceSFElemTract)</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          CALL <a class="code" href="FluidPressLoad_8f90.html#a772d75458cd6456de0c44f2770dad99f">fluidpressload</a>(glb%NumNP,rnet, &amp;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;               glb%InterfaceSFnbNumElems, glb%InterfaceSFnbNumNodes, &amp;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;               glb%InterfaceSFnbElemConn, &amp;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;               glb%MapNodeSFnb,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFnbElVolEl,&amp;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;               glb%ElConnVol,glb%iElType,glb%NumElVol,glb%InterfaceSFnbElemTract)</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;       <span class="comment">!!        ! ... This was in the Rocstar code, I replaced it with what is above COstoich, 5-14-09</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;       <span class="comment">!!        IF(glb%iElType.EQ.8)THEN</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;       <span class="comment">!!           CALL TractLoad_Hex(Rnet,glb%NumNP, &amp;  ! Don&#39;t imposed pressure on deformed coordinates</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;       <span class="comment">!!                glb%InterfaceSFElemTract, &amp;</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;       <span class="comment">!!                glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;       <span class="comment">!!                glb%InterfaceSFElemConn, &amp;</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;       <span class="comment">!!                glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor)</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;       <span class="comment">!!        ELSE</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;       <span class="comment">!!           CALL FluidPressLoad(glb%NumNP,Rnet, &amp;</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;       <span class="comment">!!                glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;       <span class="comment">!!                glb%InterfaceSFElemConn, &amp;</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;       <span class="comment">!!                glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFElVolEl,&amp;</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;       <span class="comment">!!                glb%ElConnVol,glb%iElType,glb%NumElVol,glb%InterfaceSFElemTract)</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;       <span class="comment">!!           CALL FluidPressLoad(glb%NumNP,Rnet, &amp;</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;       <span class="comment">!!                glb%InterfaceSFnbNumElems, glb%InterfaceSFnbNumNodes, &amp;</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;       <span class="comment">!!                glb%InterfaceSFnbElemConn, &amp;</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;       <span class="comment">!!                glb%MapNodeSFnb,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFnbElVolEl,&amp;</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;       <span class="comment">!!                glb%ElConnVol,glb%iElType,glb%NumElVol,glb%InterfaceSFnbElemTract)</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;       <span class="comment">!!        ENDIF</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;End Pressure Loading&#39;</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">!!$       CALL TractLoad(Rnet,glb%NumNP, &amp;</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">!!$            glb%InterfaceSFElemTract, &amp;</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">!!$            glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">!!$            glb%InterfaceSFElemConn, &amp;</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">!!$            glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFElVolEl,&amp;</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">!!$            glb%ElConnVol,glb%iElType,glb%NumElVol)</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;       <span class="comment">! -- Enforce tractions (if any) where there are no fluid&#39;s domains.</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;       <span class="comment">!    Uses the non-solid/fluid surface mesh.</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;Start traction loading&#39;</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;       <span class="keywordflow">IF</span>(glb%EnforceTractionS.OR.glb%EnforceTractionSF)<span class="keywordflow">THEN</span>    </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;          <span class="comment">!         IF(glb%UnDefConfig)THEN</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;          <span class="comment">! if using cauchy stress</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;          <span class="comment">!             CALL TractPressLoadDef(Rnet,glb%NumNP, &amp;</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          <span class="comment">!                  glb%InterfaceSNumElems, glb%InterfaceSNumNodes, &amp;</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;          <span class="comment">!                  glb%InterfaceSElemConn, &amp;</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;          <span class="comment">!                  glb%MapNodeS,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSElVolEl,&amp;</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;          <span class="comment">!                  glb%ElConnVol,glb%iElType,glb%NumElVol,glb%DummyTractVal*glb%prop)</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;          <span class="comment">!             </span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;          <span class="comment">!             IF(myid.EQ.0) PRINT*,&#39;Pressure =&#39;, glb%DummyTractVal*glb%prop</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;          <span class="comment">!          ELSE</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;          <span class="keywordflow">IF</span>(glb%iElType.EQ.8)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;             <span class="comment">! fix need other option</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;             <span class="keywordflow">IF</span>(glb%EnforceTractionS)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                CALL <a class="code" href="TractLoadPress__Hex_8f90.html#ac050aec90b08df888a8760c727678694">tractloadpress_hex</a>(rnet,glb%NumNP, &amp;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                     glb%InterfaceSNumElems, glb%InterfaceSNumNodes, &amp;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                     glb%InterfaceSElemConn, &amp;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                     glb%MapNodeS,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%DummyTractVal*glb%prop)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;             <span class="keywordflow">IF</span>(glb%EnforceTractionS)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;                CALL <a class="code" href="TractPressLoad_8f90.html#af42e32449868baac6d0fcf3cd10568f1">tractpressload</a>(rnet,glb%NumNP, &amp;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                     glb%InterfaceSNumElems, glb%InterfaceSNumNodes, &amp;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                     glb%InterfaceSElemConn, &amp;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                     glb%MapNodeS,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSElVolEl,&amp;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                     glb%ElConnVol,glb%iElType,glb%NumElVol,glb%DummyTractVal*glb%prop)</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                <span class="keywordflow">IF</span>(myid.EQ.0) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;Pressure Solid =&#39;</span>, glb%DummyTractVal*glb%prop</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;             <span class="keywordflow">IF</span>(glb%EnforceTractionSF)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                CALL <a class="code" href="TractPressLoad_8f90.html#af42e32449868baac6d0fcf3cd10568f1">tractpressload</a>(rnet,glb%NumNP, &amp;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                     glb%InterfaceSFNumElems, glb%InterfaceSFNumNodes, &amp;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                     glb%InterfaceSFElemConn, &amp;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                     glb%MapNodeSF,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFElVolEl,&amp;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                     glb%ElConnVol,glb%iElType,glb%NumElVol,glb%DummyTractVal*glb%prop)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                <span class="keywordflow">IF</span>(myid.EQ.0) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;Pressure Solid/Fluid =&#39;</span>, glb%DummyTractVal*glb%prop</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                CALL <a class="code" href="TractPressLoad_8f90.html#af42e32449868baac6d0fcf3cd10568f1">tractpressload</a>(rnet,glb%NumNP, &amp;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                     glb%InterfaceSFnbNumElems, glb%InterfaceSFnbNumNodes, &amp;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                     glb%InterfaceSFnbElemConn, &amp;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                     glb%MapNodeSFnb,glb%LwrBnd,glb%UppBnd,glb%Meshcoor,glb%Disp,glb%MapSFnbElVolEl,&amp;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                     glb%ElConnVol,glb%iElType,glb%NumElVol,glb%DummyTractVal*glb%prop)</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;          <span class="comment">!          ENDIF</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;       <span class="keywordflow">IF</span> ( .NOT.( glb%IMP ) ) <span class="keywordflow">THEN</span> <span class="comment">! Explicit Solver</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;          <span class="comment">!       Rnet(:) = 0.d0</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;          <span class="comment">! -- Calculate R_in, R_damp</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;start UpdateStructural&#39;</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;          <span class="keywordflow">IF</span>(glb%HeatTransSoln)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;             CALL <a class="code" href="classupdatestructuralsoln.html#a4f9c60529a8008c7b8dec397075274a6">updatestructuralht</a>(glb,numprocs,rnet,rnetht)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;             <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;MaxTemperature&#39;</span>,maxval(glb%Temperature)</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;             <span class="comment">! should not you have updatestrural here</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;             CALL <a class="code" href="classupdatestructuralsoln.html#af792599935a3fa32e73badfcbc480db2">updatestructural</a>(glb,numprocs,rnet)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;finished UpdateStructural&#39;</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          CALL <a class="code" href="principal__stress_8f90.html#a8dea13bc134f9f4da9c7f32d06e6d497">principal_stress</a>(glb%S11,glb%S22,glb%S33, &amp;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;               glb%S12,glb%S23,glb%S13, &amp;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;               glb%iStrGss,glb%NumElVol,glb%SVonMises)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;          <span class="comment">! -- (12) UPDATE THE ACCELERATION AND VELOCITY</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;          <span class="keywordflow">IF</span>(glb%ALEenabled)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;             <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%NumNP</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                jaux = 3*<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = jaux-2, jaux</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                   <span class="comment">! Accelerations are found by</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                   <span class="comment">!       ..           -1        ext        in</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                   <span class="comment">!     { D }     = [M]   * ( { F    } - { F   } )</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                   <span class="comment">!          i+1                           </span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                   a1 = rnet(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) * glb%xmass(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                   <span class="comment">! Store Accelerations</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                   glb%Accel(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) = a1</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;             <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;             <span class="comment">!-- (2) update mesh displacement vector (ale)</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;             <span class="comment">!       glb%DispBar(:) = glb%DT*glb%VeloBar(:)   + glb%DispBar(:)</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(.NOT.(glb%DampEnabled))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;             <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%NumNP</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                jaux = 3*<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = jaux-2, jaux</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                   <span class="comment">! Accelerations are found by</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                   <span class="comment">!       ..           -1        ext        in</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                   <span class="comment">!     { D }     = [M]   * ( { F    } - { F   } )</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                   <span class="comment">!          i+1                           </span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                   a1 = rnet(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) * glb%xmass(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                   <span class="comment">! Velocities are found by</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                   <span class="comment">!       .          .                 ..        ..</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                   <span class="comment">!     { D }    = { D }  + 0.5*Dt*( { D }  +  { D }    )</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                   <span class="comment">!          i+1        i                 i         i+1</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                   glb%VeloHalf(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) = glb%VeloHalf(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) + glb%DT * ( glb%Accel(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)+a1 ) * 0.5d0</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                   <span class="comment">! Store Accelerations</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                   glb%Accel(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) = a1</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;             <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;             <span class="comment">! Damping Enabled</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;             <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a> = 1, glb%NumNP</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                jaux = 3*<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                <span class="keywordflow">DO</span> <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = jaux-2, jaux</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                   dispprev = glb%Disp(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                   <span class="comment">! Displacement is found by</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;                   <span class="comment">!                         -1   ext    int    damp                 .</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;                   <span class="comment">! { D }    = Dt**2 * [ M ]  ( F    - F    - F    ) + { D } + Dt*{ D } </span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;                   <span class="comment">!      i+1                     i      i                 i            i-1/2</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                   glb%Disp(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)= glb%DT*glb%DT*rnet(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)*glb%xmass(<a class="code" href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a>) + glb%Disp(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) + glb%DT*glb%VeloHalf(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                   <span class="comment">! Update the velocity [ at time (i+1/2)Dt ]</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                   <span class="comment">!</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                   <span class="comment">!     .            -1     </span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                   <span class="comment">!   { D }      = Dt   ( { D }      - { D }  )</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                   <span class="comment">!        i+1/2               n + 1        n</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                   glb%VeloHalf(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>) = ( glb%Disp(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)-dispprev )* glb%DTInv</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;             <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;          <span class="comment">!     </span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;          <span class="comment">! -- (13) APPLY BOUNDARY CONDITIONS </span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;          <span class="comment">!</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;start bc&#39;</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;          <span class="keywordflow">IF</span>(glb%NumNdsBC.NE.0)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;             CALL <a class="code" href="bc__enforce_8f90.html#ac0b1c3d87ec07553fd6ba16768f8fe4d">bc_enforce</a>(glb%NumNdsBC,glb%NumNP,glb%BCFlag,glb%BCvalue,glb%slope,glb%prop,&amp;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                  glb%VeloBndry,glb%AccelBndry,glb%VeloHalf,glb%Accel,glb%Disp,glb%DT,rnet,&amp;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                  glb%xmass,glb%DampEnabled,glb%CurrTime)</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;          <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;finished bc&#39;</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          <span class="comment">!-- (1) UPDATE VELOCITY AND DISPLACEMENT VECTORS (structural)</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;          <span class="keywordflow">IF</span>(glb%ALEenabled)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;             glb%VeloHalf(:) = glb%DT*glb%Accel(:)     + glb%VeloHalf(:)</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;             glb%Disp(:)     = glb%DT*glb%VeloHalf(:) + glb%Disp(:)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;          <span class="keywordflow">ELSE</span> <span class="keywordflow">IF</span>(.NOT.(glb%DampEnabled))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;             <span class="comment">!          glb%VeloHalf(k) = glb%VeloHalf(k) + glb%DT * ( glb%Accel(k)+a1 ) * 0.5d0</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;             <span class="comment">! Displacement is found by</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;             <span class="comment">!</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;             <span class="comment">!                         -1   ext    int    damp                 .</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;             <span class="comment">! { D }    = Dt**2 * [ M ]  ( F    - F    - F    ) + { D } + Dt*{ D } </span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;             <span class="comment">!      i+1                     i      i                 i            i-1/2</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;             <span class="comment">!          PRINT*,glb%DT*glb%DT*glb%Accel(:)*0.5d0,glb%DT*glb%VeloHalf(:)</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;             glb%Disp(:) = glb%DT*glb%DT*glb%Accel(:)*0.5d0 + glb%DT*glb%VeloHalf(:) + glb%Disp(:)</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;          <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;       <span class="keywordflow">ELSE</span> <span class="comment">! Implicit Solver</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;          <span class="comment">! ... Temporary, for thermal solver development, CHANGE!! COstoich 02/23/09</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;          <span class="keywordflow">IF</span> ( glb%HeatTransSoln ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;             CALL <a class="code" href="thermal__soln_8f90.html#aea32be7524872ece15e425260e4e832e">thermal_soln</a>(currenttimestep,currenttime,rnetht,glb,istep)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;             CALL <a class="code" href="implicit__soln_8f90.html#a1061eef86f2c69132d338009f20ff15c">implicit_soln</a>(currenttimestep,currenttime,rnet,glb)</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;          nsubstep = 0  <span class="comment">! stop trying to sub-step</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;          <span class="comment">! DEBUG</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;          tempf1 = 0.0</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumNP</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;             tempf2 = glb%Disp(3*<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>-2)*glb%Disp(3*<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>-2) + glb%Disp(3*<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>-1)*glb%Disp(3*<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>-1) + glb%Disp(3*<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)*glb%Disp(3*<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;             tempf1 = <a class="code" href="Vector__n_8h.html#a7dddfa733bea2c50f405764d775e636a">max</a>(tempf1,tempf2)</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;          tempf1 = <a class="code" href="double_8h.html#ac12b3d29117dc72313c36cdb5a9d3e0e">sqrt</a>(tempf1)</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;          <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,myid,currenttime+currenttimestep,<span class="stringliteral">&#39;999 999&#39;</span>,tempf1</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;          <span class="keywordflow">IF</span> ( abs(maxval(glb%Disp(:))) &gt; abs(minval(glb%Disp(:))) ) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;             <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,myid,currenttime+currenttimestep,<span class="stringliteral">&#39;888 888&#39;</span>,maxval(glb%Disp(:))</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;          <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;             <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,myid,currenttime+currenttimestep,<span class="stringliteral">&#39;888 888&#39;</span>,minval(glb%Disp(:))</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;          <span class="keywordflow">END IF</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;          <span class="comment">! END DEBUG</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;       <span class="keywordflow">END IF</span> <span class="comment">! IMP</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;MAX DISPLACEMENT =&#39;</span>, maxval(glb%Disp(:))</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment">!!$       DO i = 1, 3*glb%numnp</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">!!$          IF(glb%Disp(i).NE.0.d0) PRINT*,i,glb%Disp(i)</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment">!!$       ENDDO</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;       glb%DispTotal(:) = glb%Disp(:) + glb%DispBar(:)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">!!$       DO i = 1, glb%NumNodeIO</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">!!$          WRITE(33+i,*) glb%CurrTime, glb%DispTotal(3*glb%NodeIO(i)-2:3*glb%NodeIO(i))</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">!!$       ENDDO</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;       <span class="comment">!       IF(glb%NumNodeIO.NE.0)THEN</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;       <span class="comment">!          write(400,*) glb%CurrTime, glb%Disp(glb%NumNodeIO*3-2)</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;       <span class="comment">! print*,myid,glb%Meshcoor(1:3,glb%NumNodeIO)</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;       <span class="comment">!       endif</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;       <span class="comment">!       PRINT*,&#39;Max Displacement&#39;, MAXval(glb%Disp)</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;       <span class="comment">!        PRINT*,&#39;Min Displacement&#39;, minval(glb%Disp)</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;       <span class="comment">! -- Mass/Volume Conservation</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;       <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;finished mass volume conservation&#39;</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;       glb%TotalMassSolidp = 0.d0</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;       glb%TotalGeomVolp = 0.d0</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;       <span class="keywordflow">IF</span>(glb%iElType.EQ.4 .OR. glb%iElType.EQ.10 .AND.(.NOT.(glb%NdBasedEl)) )<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;          CALL <a class="code" href="v3d4__volume_8f90.html#a27225dda763a5c16405ad0b8c729ac8b">v3d4_volume</a>(glb%MeshCoor,glb%ElConnVol,glb%MatIdVol,glb%rho, &amp;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;               glb%NumNP,glb%NumElVol,glb%NumMatVol,glb%Disp,1,glb%NumElVol,&amp;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;               glb%TotalMassSolidp,glb%TotalGeomVolp,glb%TotalGeomUndefVolp, &amp;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;               glb%iElType)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;       <span class="keywordflow">IF</span> (glb%HeatTransSoln)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumProbesNd</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;             <span class="keywordflow">IF</span>(glb%PointOnProc(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                <span class="keyword">WRITE</span>(ichr1,<span class="stringliteral">&#39;(i4.4)&#39;</span>) <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                <span class="keyword">WRITE</span>(ichr2,<span class="stringliteral">&#39;(I4.4)&#39;</span>) myid</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                <span class="keyword">OPEN</span>(440+<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,file=<span class="stringliteral">&#39;Rocfrac/Rocout/Probe.&#39;</span>//ichr1//<span class="stringliteral">&#39;.&#39;</span>//ichr2,position=<span class="stringliteral">&#39;APPEND&#39;</span>)</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                <span class="keyword">WRITE</span>(440+<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,*) glb%CurrTime, glb%Temperature(glb%ProbeNd(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>))</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                <span class="keyword">close</span>(440+<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;          <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumProbesNd</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;             <span class="keywordflow">IF</span>(glb%PointOnProc(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>))<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                <span class="keyword">WRITE</span>(ichr1,<span class="stringliteral">&#39;(i4.4)&#39;</span>) <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                <span class="keyword">WRITE</span>(ichr2,<span class="stringliteral">&#39;(I4.4)&#39;</span>) myid</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                <span class="keyword">OPEN</span>(440+<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,file=<span class="stringliteral">&#39;Rocfrac/Rocout/Probe.&#39;</span>//ichr1//<span class="stringliteral">&#39;.&#39;</span>//ichr2,position=<span class="stringliteral">&#39;APPEND&#39;</span>)</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                <span class="keyword">WRITE</span>(440+<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>,*) glb%CurrTime, glb%Disp( glb%ProbeNd(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)*3-2), glb%Disp( glb%ProbeNd(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)*3-1) , glb%Disp( glb%ProbeNd(<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)*3)  <span class="comment">! glb%Temperature(glb%ProbeNd(i))</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                <span class="keyword">close</span>(440+<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>)</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;             <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">ENDDO</span>  <span class="comment">! substepping</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keyword">DEALLOCATE</span>(rnet)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">IF</span>(<a class="code" href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">debug</a>) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;structural boundary conditions start&#39;</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    icnt1 = 1</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    icnt5 = 0</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%NumNdsBCcrypt</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;       ndbcflag = mod(glb%BCFlagCrypt(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>),100)</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;       <span class="comment">! structural boundary conditions</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;       <span class="keywordflow">IF</span>(ndbcflag.GT.0) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;          icnt5 = icnt5 + 1</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;          glb%BCValueGlb(icnt1:icnt1+2) = glb%AccelBndry(icnt5*3-2:icnt5*3)</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;          icnt1 = icnt1 + 3</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;          glb%BCValueGlb(icnt1:icnt1+2) = glb%VeloBndry(icnt5*3-2:icnt5*3)</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;          icnt1 = icnt1 + 3</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="keywordflow">IF</span>(myid.EQ.0) <a class="code" href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">print</a>*,<span class="stringliteral">&#39;RocFrac :: END SOLID STEP&#39;</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    CALL <a class="code" href="classrocfracmain.html#abcb89d944827dbce26cd9199cd53c504">rocfracinterfacebuff</a>(glb)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="classrocfracmain.html#af8df50c77956c23e6df0da51df12145d">rocfracsoln</a></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">! ----------------------------------------------------------------------- RocFracInterfaceBuff</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div>
<div class="line"><a name="l01992"></a><span class="lineno"><a class="line" href="classrocfracmain.html#abcb89d944827dbce26cd9199cd53c504"> 1992</a></span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="classrocfracmain.html#abcb89d944827dbce26cd9199cd53c504">rocfracinterfacebuff</a>(glb)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment">!!****f* Rocfrac/Rocfrac/Source/RocFracMain</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">!!  NAME</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">!!    RocFracInterfaceBuff</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment">!!  FUNCTION</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">!!  Passes the variables to the fluid code. It transfers the new mesh </span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment">!!  velocity and displacement to the interface mesh  arrays that are</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment">!!  registered with RocCom </span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">!!</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">!!***</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="keywordtype">TYPE(</span><a class="code" href="structrocstar__rocfrac_1_1rocfrac__global.html">rocfrac_global</a><span class="keywordtype">)</span> :: glb</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordtype">INTEGER</span> :: iinterfacenode</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordtype">INTEGER</span> :: <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>,k1,k2,k3</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordtype">INTEGER</span> :: myid,ierr</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">DO</span> iinterfacenode = 1, glb%InterfaceSFNumNodes</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;       <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = glb%MapNodeSF(iinterfacenode)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;       k3 = 3*<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;       k2 = k3 - 1</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;       k1 = k3 - 2</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">! Move the interface mesh to match the volume mesh</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;       glb%InterfaceSFNodalCoors(1:3,iinterfacenode) = glb%MeshCoor(1:3,<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">! Total Displacement due to structural tractions (not due to mesh motion)</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;       glb%InterfaceSFTotalNodalDisps(1,iinterfacenode) = glb%Disp(k1)</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;       glb%InterfaceSFTotalNodalDisps(2,iinterfacenode) = glb%Disp(k2)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;       glb%InterfaceSFTotalNodalDisps(3,iinterfacenode) = glb%Disp(k3)</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">! </span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">! Incremental Total Displacement</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">!       </span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;       glb%InterfaceSFNodalDisps(1,iinterfacenode) = glb%Disp(k1) + glb%DispBar(k1) </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;       glb%InterfaceSFNodalDisps(2,iinterfacenode) = glb%Disp(k2) + glb%DispBar(k2) </div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;       glb%InterfaceSFNodalDisps(3,iinterfacenode) = glb%Disp(k3) + glb%DispBar(k3)</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">! </span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">! Acceleration</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">!       </span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;       glb%InterfaceSFNodalAccel(1,iinterfacenode) = glb%Accel(k1) </div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;       glb%InterfaceSFNodalAccel(2,iinterfacenode) = glb%Accel(k2)</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;       glb%InterfaceSFNodalAccel(3,iinterfacenode) = glb%Accel(k3) </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">! Passing the velocity, Vs</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">! Structural Velocity ! same</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;       glb%InterfaceSFNodalVels(1,iinterfacenode) = glb%VeloHalf(k1) <span class="comment">! fix: need more terms</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;       glb%InterfaceSFNodalVels(2,iinterfacenode) = glb%VeloHalf(k2) <span class="comment">! fix: need more terms</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;       glb%InterfaceSFNodalVels(3,iinterfacenode) = glb%VeloHalf(k3) <span class="comment">! fix: need more terms</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    <span class="keywordflow">DO</span> iinterfacenode = 1, glb%InterfaceSFnbNumNodes</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;       <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = glb%MapNodeSFnb(iinterfacenode)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;       k3 = 3*<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;       k2 = k3 - 1</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;       k1 = k3 - 2</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">! Move the interface mesh to match the volume mesh</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;       glb%InterfaceSFnbNodalCoors(1:3,iinterfacenode) = glb%MeshCoor(1:3,<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">! Total Displacement due to structural tractions (not due to mesh motion)</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;       glb%InterfaceSFnbTotalNodalDisps(1,iinterfacenode) = glb%Disp(k1)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;       glb%InterfaceSFnbTotalNodalDisps(2,iinterfacenode) = glb%Disp(k2)</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;       glb%InterfaceSFnbTotalNodalDisps(3,iinterfacenode) = glb%Disp(k3)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">! </span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">! Incremental Total Displacement</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">!       </span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;       glb%InterfaceSFnbNodalDisps(1,iinterfacenode) = glb%Disp(k1) + glb%DispBar(k1) </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;       glb%InterfaceSFnbNodalDisps(2,iinterfacenode) = glb%Disp(k2) + glb%DispBar(k2) </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;       glb%InterfaceSFnbNodalDisps(3,iinterfacenode) = glb%Disp(k3) + glb%DispBar(k3)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">! Passing the velocity, Vs</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">! Structural Velocity ! same</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;       glb%InterfaceSFnbNodalVels(1,iinterfacenode) = glb%VeloHalf(k1) <span class="comment">! fix: need more terms</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;       glb%InterfaceSFnbNodalVels(2,iinterfacenode) = glb%VeloHalf(k2) <span class="comment">! fix: need more terms</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;       glb%InterfaceSFnbNodalVels(3,iinterfacenode) = glb%VeloHalf(k3) <span class="comment">! fix: need more terms</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">! Acceleration</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;       glb%InterfaceSFnbNodalAccel(1,iinterfacenode) = glb%Accel(k1)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;       glb%InterfaceSFnbNodalAccel(2,iinterfacenode) = glb%Accel(k2)</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;       glb%InterfaceSFnbNodalAccel(3,iinterfacenode) = glb%Accel(k3)</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    <span class="keywordflow">IF</span>(glb%HeatTransSoln)<span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;       <span class="comment">! ... if implicit thermal solver (Roctherm), then only non-burning</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;       <span class="comment">! ... interaction is supported</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;       <span class="keywordflow">IF</span> (glb%IMP .EQV. .true.) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;          <span class="keywordflow">DO</span> iinterfacenode = 1, glb%InterfaceSFnbNumNodes</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;             <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = glb%MapNodeSFnb(iinterfacenode)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;             </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;             glb%InterfaceSFnbNodalTemp(iinterfacenode) = glb%Temperature(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;       <span class="keywordflow">ELSE</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;          <span class="keywordflow">DO</span> iinterfacenode = 1, glb%InterfaceSFNumNodes</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;             <a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a> = glb%MapNodeSF(iinterfacenode)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;             </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;             glb%InterfaceSFNodalTemp(iinterfacenode) = glb%Temperature(<a class="code" href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a>)</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;             </div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;          <span class="keywordflow">ENDDO</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;       <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keywordflow">ENDIF</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">! Is this needed still?</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">!!$    DO iInterfaceNode = 1, glb%InterfaceSNumNodes</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">!!$       k = glb%MapNodeS(iInterfaceNode)</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="comment">!!$! Move the interface mesh to match the volume mesh</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="comment">!!$       glb%InterfaceSNodalCoors(1:3,iInterfaceNode) = glb%MeshCoor(1:3,k)</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">RETURN</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;         </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="classrocfracmain.html#abcb89d944827dbce26cd9199cd53c504">rocfracinterfacebuff</a></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;</div>
<div class="line"><a name="l02126"></a><span class="lineno"><a class="line" href="classrocfracmain.html#ade382b3b948b8dccc8e8f2800c4ac092"> 2126</a></span>&#160;<span class="keyword">  SUBROUTINE </span><a class="code" href="classrocfracmain.html#ade382b3b948b8dccc8e8f2800c4ac092">rocfracupdateinbuff</a>( glb, alpha)</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordtype">TYPE(</span><a class="code" href="structrocstar__rocfrac_1_1rocfrac__global.html">rocfrac_global</a><span class="keywordtype">)</span>, <span class="keywordtype">POINTER</span> :: glb</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keywordtype">REAL*8</span>, <span class="keywordtype">INTENT(IN)</span>            :: <a class="code" href="classColor.html#af94d15b3f5e32b9137fc219dcb16bd53">alpha</a></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="keywordtype">INTEGER</span> :: triconn(1:3)</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordtype">INTEGER</span> :: <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordtype">REAL*8</span> :: radius, signx,signy,signz</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordtype">REAL*8</span> :: prop </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">SAVE</span> :: icnt</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keywordtype">REAL*8</span> :: tractval</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keywordtype">REAL*8</span> :: <a class="code" href="classGeoPrim_1_1CLine.html#ace0714fea207254cf9ff1fff7f352511">slope</a>,<a class="code" href="classvector3d.html#acd0002100974a4648cdac68b2d732659">mag</a></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">!!$    icnt = icnt + 1</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">!!$    IF(mod(icnt,26).eq.0) THEN</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">!!$       prop = float(icnt/26)*glb%DummyTractVal</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">!!$       print*,&#39;**PRESSURE=&#39;, prop</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">!!$       write(44,*) glb%CurrTime,prop</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">!!$    endif</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">! Wind Block </span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(glb%LwrBnd:glb%UppBnd,i)</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment">!!$       IF(glb%coor(1,glb%MapNodeSF(TriConn(1))) .LT. 0.276d0 .AND. &amp;</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment">!!$            glb%coor(1,glb%MapNodeSF(TriConn(2))) .LT. 0.276d0 .AND. &amp;</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">!!$            glb%coor(1,glb%MapNodeSF(TriConn(3))) .LT. 0.276d0 ) THEN</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = glb%DummyTractVal</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2:3,i) = 0.d0</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">!!$       ELSE</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(:,i) = 0.d0</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">!!$       ENDIF</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">!!$!    glb%InterfaceSVbar(:,1:glb%InterfaceSNumNodes) = 0.d0</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumNodes</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment">!!$       IF(glb%coor(1,glb%MapNodeSF(i)) .LT. 0.276d0) THEN</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">!!$          glb%InterfaceSFVbar(1,i) = glb%DummyBurnRate</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">!!$          glb%InterfaceSFVbar(2:3,i) = 0.d0</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment">!!$       ELSE</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">!!$          glb%InterfaceSFVbar(:,i) = 0.d0</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">!!$       ENDIF</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">! Scaleability</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">!!$     DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(glb%LwrBnd:glb%UppBnd,i)</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">!!$       signx= SUM( glb%coor(1,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment">!!$       signy= SUM( glb%coor(2,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment">!!$       radius = SQRT( signx**2 + signy**2)</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(1,i) = signx/radius*glb%DummyTractVal</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(2,i) = signy/radius*glb%DummyTractVal</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">!!$!    glb%InterfaceSVbar(:,1:glb%InterfaceSNumNodes) = 0.d0</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumNodes</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">!!$       radius = SQRT( glb%coor(1,glb%MapNodeSF(i))**2 + &amp;</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">!!$            glb%coor(2,glb%MapNodeSF(i))**2)</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">!!$ </span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(1,i) = glb%coor(1,glb%MapNodeSF(i))/radius*glb%DummyBurnRate</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(2,i) = glb%coor(2,glb%MapNodeSF(i))/radius*glb%DummyBurnRate</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(3,i) = 0.d0</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">!!$    ENDDO      </span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="comment">! Mass Conservation</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="comment">!!$     DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(glb%LwrBnd:glb%UppBnd,i)</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(1:2,i) = 0.d0</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(3,i) = glb%DummyTractVal</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">!!$!    glb%InterfaceSVbar(:,1:glb%InterfaceSNumNodes) = 0.d0</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumNodes</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(3,i) = glb%DummyBurnRate</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(1:2,i) = 0.d0</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="comment">!!$    ENDDO </span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">! Hollow Sphere</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">!!$     DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(glb%LwrBnd:glb%UppBnd,i)</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">!!$       signx= SUM( glb%coor(1,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">!!$       signy= SUM( glb%coor(2,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">!!$       signz= SUM( glb%coor(3,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">!!$       radius = SQRT( signx**2 + signy**2 + signz**2)</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(1,i) = signx/radius*glb%DummyTractVal</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(2,i) = signy/radius*glb%DummyTractVal</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(3,i) = signz/radius*glb%DummyTractVal</span></div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">!!$!    glb%InterfaceSVbar(:,1:glb%InterfaceSNumNodes) = 0.d0</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">!!$! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumNodes</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">!!$       radius = SQRT( glb%coor(1,glb%MapNodeSF(i))**2 + &amp;</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">!!$            glb%coor(2,glb%MapNodeSF(i))**2 + glb%coor(3,glb%MapNodeSF(i))**2)</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">!!$ </span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(1,i) = glb%coor(1,glb%MapNodeSF(i))/radius*glb%DummyBurnRate</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(2,i) = glb%coor(2,glb%MapNodeSF(i))/radius*glb%DummyBurnRate</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">!!$       glb%InterfaceSFVbar(3,i) = glb%coor(3,glb%MapNodeSF(i))/radius*glb%DummyBurnRate</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">!!$    ENDDO  </span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion (Not on F/S interface)</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment">!    glb%InterfaceSVbar(:,1:glb%InterfaceSNumNodes) = 0.d0</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">! -- Enforce Mesh Velocity BC&#39;s of Mesh Motion Given by the fluids.</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keywordflow">DO</span> <a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a> = 1, glb%InterfaceSFNumNodes</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;       glb%InterfaceSFVbar(1,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = 0.00075 <span class="comment">! glb%DummyBurnRate</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;       glb%InterfaceSFVbar(2,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = 0.</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;       glb%InterfaceSFVbar(3,<a class="code" href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a>) = 0.</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;       </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">ENDDO</span>  </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">! 2 Material Beam</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">!!$     DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(glb%LwrBnd:glb%UppBnd,i)</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(1,i) = 0.d0</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(2,i) = -glb%DummyTractVal</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment">! 5 sided cube</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">!!$    glb%InterfaceSFElemTract(:,:) = 0.d0</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">!!$    IF(glb%CurrTime.LE.0.1d0)THEN</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">!!$       slope = glb%DummyTractVal/0.1d0</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment">!!$       prop = slope*glb%CurrTime</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment">!!$       print*,&#39; PRESSURE =&#39;, prop</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment">!!$    else</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment">!!$       prop = 0.d0</span></div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment">!!$    endif</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment">!!$    mag = 0.d0</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(1:3,i)</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment">!!$! y = 0.9 face</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment">!!$       IF(glb%coor(2,glb%MapNodeSF(TriConn(1))) .GT. 0.89999d0 .AND. &amp;</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment">!!$            glb%coor(2,glb%MapNodeSF(TriConn(2))) .GT. 0.89999d0 .AND. &amp;</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment">!!$            glb%coor(2,glb%MapNodeSF(TriConn(3))) .GT. 0.89999d0 ) THEN</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = 0.d0</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2,i) = -prop</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="comment">!!$! z = 0.9 face</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment">!!$       ELSE IF(glb%coor(3,glb%MapNodeSF(TriConn(1))) .GT. 0.89999d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">!!$            glb%coor(3,glb%MapNodeSF(TriConn(2))) .GT. 0.89999d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">!!$            glb%coor(3,glb%MapNodeSF(TriConn(3))) .GT. 0.89999d0+mag ) THEN</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = 0.d0</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2,i) = 0.d0</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(3,i) = -prop</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment">!!$! z = 0.0 face</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">!!$       ELSE IF(glb%coor(3,glb%MapNodeSF(TriConn(1))) .LT. 0.00001d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">!!$            glb%coor(3,glb%MapNodeSF(TriConn(2))) .LT. 0.00001d0 +mag.AND. &amp;</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">!!$            glb%coor(3,glb%MapNodeSF(TriConn(3))) .LT. 0.00001d0+mag ) THEN</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = 0.d0</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2,i) = 0.d0</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(3,i) = prop</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment">!!$! x = 0.9 face</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">!!$       ELSE IF(glb%coor(1,glb%MapNodeSF(TriConn(1))) .GT. 0.89999d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">!!$            glb%coor(1,glb%MapNodeSF(TriConn(2))) .GT. 0.89999d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">!!$            glb%coor(1,glb%MapNodeSF(TriConn(3))) .GT. 0.89999d0+mag ) THEN</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = -prop</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2,i) = 0.d0</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment">!!$! x = 0.0 face</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment">!!$       ELSE IF(glb%coor(1,glb%MapNodeSF(TriConn(1))) .LT. 0.00001d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment">!!$            glb%coor(1,glb%MapNodeSF(TriConn(2))) .LT. 0.00001d0+mag .AND. &amp;</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment">!!$            glb%coor(1,glb%MapNodeSF(TriConn(3))) .LT. 0.00001d0+mag ) THEN</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = prop </span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2,i) = 0.d0</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">!!$       endif</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">!!$    </span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment">! Cantilever beam</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment">!!$    glb%InterfaceSFElemTract(:,:) = 0.d0</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment">!!$    IF(glb%CurrTime.LE.0.05d0)THEN</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment">!!$       slope = glb%DummyTractVal/0.05d0</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment">!!$       prop = slope*glb%CurrTime</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment">!!$       print*,&#39; PRESSURE =&#39;, prop</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment">!!$    ELSE</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment">!!$       prop = 0.d0</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">!!$    ENDIF</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">!!$    DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(1:3,i)</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">!!$! y = 0.25 face</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">!!$       IF(glb%coor(2,glb%MapNodeSF(TriConn(1))) .GT.   0.2499d0 .AND. &amp;</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">!!$            glb%coor(2,glb%MapNodeSF(TriConn(2))) .GT. 0.2499d0 .AND. &amp;</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">!!$            glb%coor(2,glb%MapNodeSF(TriConn(3))) .GT. 0.2499d0 ) THEN</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">!!$          </span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(1,i) = 0.d0</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(2,i) = -prop</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment">!!$          glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">!!$       ENDIF    </span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">! Propellent/Case</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">!!$     DO i = 1, glb%InterfaceSFNumElems</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">!!$     </span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="comment">!!$       TriConn(1:3) = glb%InterfaceSFElemConn(glb%LwrBnd:glb%UppBnd,i)</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">!!$       signx= SUM( glb%coor(1,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">!!$       signy= SUM( glb%coor(2,glb%MapNodeSF(TriConn(1:3))) ) / 3.0d0</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">!!$       radius = SQRT( signx**2 + signy**2)</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">!!$       TractVal = MIN(1.d0, Prop/25.d0  )*glb%DummyTractVal</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">!!$</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(1,i) = signx/radius*TractVal</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(2,i) = signy/radius*TractVal</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">!!$       glb%InterfaceSFElemTract(3,i) = 0.d0</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">!!$       </span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">!!$    ENDDO</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;      </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="keyword">  END SUBROUTINE </span><a class="code" href="classrocfracmain.html#ade382b3b948b8dccc8e8f2800c4ac092">rocfracupdateinbuff</a></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;   </div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="keyword">END MODULE </span><a class="code" href="classrocfracmain.html">rocfracmain</a></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div>
<div class="ttc" id="classrocstar__rocfraccomm_html"><div class="ttname"><a href="classrocstar__rocfraccomm.html">rocstar_rocfraccomm</a></div><div class="ttdef"><b>Definition:</b> <a href="ROCSTAR__RocFracComm_8f90_source.html#l00053">ROCSTAR_RocFracComm.f90:53</a></div></div>
<div class="ttc" id="ConductivityTensor_8f90_html_a62e3a615b4f9b50e3a3dd261fdd31c51"><div class="ttname"><a href="ConductivityTensor_8f90.html#a62e3a615b4f9b50e3a3dd261fdd31c51">conductivitytensor</a></div><div class="ttdeci">subroutine conductivitytensor(NumMatVol, k, dmat)</div><div class="ttdef"><b>Definition:</b> <a href="ConductivityTensor_8f90_source.html#l00002">ConductivityTensor.f90:2</a></div></div>
<div class="ttc" id="classrocfracsubinterface_html"><div class="ttname"><a href="classrocfracsubinterface.html">rocfracsubinterface</a></div><div class="ttdef"><b>Definition:</b> <a href="RocFracSubInterface_8f90_source.html#l00054">RocFracSubInterface.f90:54</a></div></div>
<div class="ttc" id="classrocstar__rocfrac_html"><div class="ttname"><a href="classrocstar__rocfrac.html">rocstar_rocfrac</a></div><div class="ttdef"><b>Definition:</b> <a href="ROCSTAR__RocFrac_8f90_source.html#l00053">ROCSTAR_RocFrac.f90:53</a></div></div>
<div class="ttc" id="implicit__initialize_8f90_html_afd4645439bc0ee9bb11e74c6f1e31832"><div class="ttname"><a href="implicit__initialize_8f90.html#afd4645439bc0ee9bb11e74c6f1e31832">implicit_initialize</a></div><div class="ttdeci">subroutine implicit_initialize(global)</div><div class="ttdef"><b>Definition:</b> <a href="implicit__initialize_8f90_source.html#l00074">implicit_initialize.f90:74</a></div></div>
<div class="ttc" id="vol__elem__mat__matous_8f90_html_a965d115f5235ae32c90f9ae08a0a6f60"><div class="ttname"><a href="vol__elem__mat__matous_8f90.html#a965d115f5235ae32c90f9ae08a0a6f60">vol_elem_mat_matous</a></div><div class="ttdeci">subroutine vol_elem_mat_matous(glb)</div><div class="ttdef"><b>Definition:</b> <a href="vol__elem__mat__matous_8f90_source.html#l00053">vol_elem_mat_matous.f90:53</a></div></div>
<div class="ttc" id="vol__elem__mat_8f90_html_a6d64aa02f525927bf36ac250b83afbb0"><div class="ttname"><a href="vol__elem__mat_8f90.html#a6d64aa02f525927bf36ac250b83afbb0">vol_elem_mat</a></div><div class="ttdeci">subroutine vol_elem_mat(e, xnu, ci, cj, numat_vol, Integration)</div><div class="ttdef"><b>Definition:</b> <a href="vol__elem__mat_8f90_source.html#l00053">vol_elem_mat.f90:53</a></div></div>
<div class="ttc" id="Indexing_8h_html_abd04f52293cfebedce75fd4b033ec190"><div class="ttname"><a href="Indexing_8h.html#abd04f52293cfebedce75fd4b033ec190">k</a></div><div class="ttdeci">j indices k indices k</div><div class="ttdef"><b>Definition:</b> <a href="Indexing_8h_source.html#l00006">Indexing.h:6</a></div></div>
<div class="ttc" id="thermal__initialize_8f90_html_a00dc899d29f6c95a9d143a4224c8a6b1"><div class="ttname"><a href="thermal__initialize_8f90.html#a00dc899d29f6c95a9d143a4224c8a6b1">thermal_initialize</a></div><div class="ttdeci">subroutine thermal_initialize(global)</div><div class="ttdef"><b>Definition:</b> <a href="thermal__initialize_8f90_source.html#l00023">thermal_initialize.f90:23</a></div></div>
<div class="ttc" id="Vector__n_8h_html_a7dddfa733bea2c50f405764d775e636a"><div class="ttname"><a href="Vector__n_8h.html#a7dddfa733bea2c50f405764d775e636a">max</a></div><div class="ttdeci">Vector_n max(const Array_n_const &amp;v1, const Array_n_const &amp;v2)</div><div class="ttdef"><b>Definition:</b> <a href="Vector__n_8h_source.html#l00354">Vector_n.h:354</a></div></div>
<div class="ttc" id="classupdatestructuralsoln_html_af792599935a3fa32e73badfcbc480db2"><div class="ttname"><a href="classupdatestructuralsoln.html#af792599935a3fa32e73badfcbc480db2">updatestructuralsoln::updatestructural</a></div><div class="ttdeci">subroutine updatestructural(glb, NumProcs, Rnet)</div><div class="ttdef"><b>Definition:</b> <a href="UpdateStructuralSoln_8f90_source.html#l00061">UpdateStructuralSoln.f90:61</a></div></div>
<div class="ttc" id="TractPressLoad_8f90_html_af42e32449868baac6d0fcf3cd10568f1"><div class="ttname"><a href="TractPressLoad_8f90.html#af42e32449868baac6d0fcf3cd10568f1">tractpressload</a></div><div class="ttdeci">subroutine tractpressload(R_ex, numnp, InterfaceSFNumElems, InterfaceSFNumNodes, InterfaceSFElemConn, MapNodeSF, LwrBnd, UppBnd, coor, Disp, MapSFElVolEl, ElConnVol, iElType, NumElVol, TractPress)</div><div class="ttdef"><b>Definition:</b> <a href="TractPressLoad_8f90_source.html#l00053">TractPressLoad.f90:53</a></div></div>
<div class="ttc" id="classrocfracmain_html_a528eefffb0ac5281d70ae23fb12b9350"><div class="ttname"><a href="classrocfracmain.html#a528eefffb0ac5281d70ae23fb12b9350">rocfracmain::rocfracinitialize</a></div><div class="ttdeci">subroutine, public rocfracinitialize(glb, InitialTime, MPI_COMM_ROCSTAR, MAN_init, surfIn, volIn, obtain_attr)</div><div class="ttdef"><b>Definition:</b> <a href="RocFracMain_8f90_source.html#l00111">RocFracMain.f90:111</a></div></div>
<div class="ttc" id="double_8h_html_ac12b3d29117dc72313c36cdb5a9d3e0e"><div class="ttname"><a href="double_8h.html#ac12b3d29117dc72313c36cdb5a9d3e0e">sqrt</a></div><div class="ttdeci">double sqrt(double d)</div><div class="ttdef"><b>Definition:</b> <a href="double_8h_source.html#l00073">double.h:73</a></div></div>
<div class="ttc" id="classimplicit__global_html"><div class="ttname"><a href="classimplicit__global.html">implicit_global</a></div><div class="ttdef"><b>Definition:</b> <a href="implicit__global_8f90_source.html#l00076">implicit_global.f90:76</a></div></div>
<div class="ttc" id="classrocfracmain_html_abcb89d944827dbce26cd9199cd53c504"><div class="ttname"><a href="classrocfracmain.html#abcb89d944827dbce26cd9199cd53c504">rocfracmain::rocfracinterfacebuff</a></div><div class="ttdeci">subroutine rocfracinterfacebuff(glb)</div><div class="ttdef"><b>Definition:</b> <a href="RocFracMain_8f90_source.html#l01839">RocFracMain.f90:1839</a></div></div>
<div class="ttc" id="feminp_8f90_html_aabc13a47fa60757716526f304ff82ad6"><div class="ttname"><a href="feminp_8f90.html#aabc13a47fa60757716526f304ff82ad6">feminp</a></div><div class="ttdeci">subroutine feminp(glb, myid)</div><div class="ttdef"><b>Definition:</b> <a href="feminp_8f90_source.html#l00053">feminp.f90:53</a></div></div>
<div class="ttc" id="TractLoadPress__Hex_8f90_html_ac050aec90b08df888a8760c727678694"><div class="ttname"><a href="TractLoadPress__Hex_8f90.html#ac050aec90b08df888a8760c727678694">tractloadpress_hex</a></div><div class="ttdeci">subroutine tractloadpress_hex(R_ex, numnp, InterfaceNumElems, InterfaceNumNodes, InterfaceElemConn, MapNode, LwrBnd, UppBnd, coor, InterfaceElemTract)</div><div class="ttdef"><b>Definition:</b> <a href="TractLoadPress__Hex_8f90_source.html#l00053">TractLoadPress_Hex.f90:53</a></div></div>
<div class="ttc" id="thermal__finalize_8f90_html_afc757ca8f4817bfc0821efcf39c0cab0"><div class="ttname"><a href="thermal__finalize_8f90.html#afc757ca8f4817bfc0821efcf39c0cab0">thermal_finalize</a></div><div class="ttdeci">subroutine thermal_finalize(global)</div><div class="ttdef"><b>Definition:</b> <a href="thermal__finalize_8f90_source.html#l00073">thermal_finalize.f90:73</a></div></div>
<div class="ttc" id="implicit__soln_8f90_html_a1061eef86f2c69132d338009f20ff15c"><div class="ttname"><a href="implicit__soln_8f90.html#a1061eef86f2c69132d338009f20ff15c">implicit_soln</a></div><div class="ttdeci">subroutine implicit_soln(delt, t, fext_in, global)</div><div class="ttdef"><b>Definition:</b> <a href="implicit__soln_8f90_source.html#l00053">implicit_soln.f90:53</a></div></div>
<div class="ttc" id="classrocfracmain_html"><div class="ttname"><a href="classrocfracmain.html">rocfracmain</a></div><div class="ttdef"><b>Definition:</b> <a href="RocFracMain_8f90_source.html#l00054">RocFracMain.f90:54</a></div></div>
<div class="ttc" id="classupdatestructuralsoln_html_a4f9c60529a8008c7b8dec397075274a6"><div class="ttname"><a href="classupdatestructuralsoln.html#a4f9c60529a8008c7b8dec397075274a6">updatestructuralsoln::updatestructuralht</a></div><div class="ttdeci">subroutine updatestructuralht(glb, NumProcs, Rnet, RnetHT)</div><div class="ttdef"><b>Definition:</b> <a href="UpdateStructuralSoln_8f90_source.html#l00324">UpdateStructuralSoln.f90:324</a></div></div>
<div class="ttc" id="FluidPressLoad_8f90_html_a772d75458cd6456de0c44f2770dad99f"><div class="ttname"><a href="FluidPressLoad_8f90.html#a772d75458cd6456de0c44f2770dad99f">fluidpressload</a></div><div class="ttdeci">subroutine fluidpressload(NumNP, R_ex, InterfaceSFNumElems, InterfaceSFNumNodes, InterfaceSFElemConn, MapNodeSF, LwrBnd, UppBnd, coor, Disp, MapSFElVolEl, ElConnVol, iElType, NumElVol, TractPress)</div><div class="ttdef"><b>Definition:</b> <a href="FluidPressLoad_8f90_source.html#l00053">FluidPressLoad.f90:53</a></div></div>
<div class="ttc" id="classrocstar__rocfracinterp_html"><div class="ttname"><a href="classrocstar__rocfracinterp.html">rocstar_rocfracinterp</a></div><div class="ttdef"><b>Definition:</b> <a href="ROCSTAR__RocFracInterp_8f90_source.html#l00053">ROCSTAR_RocFracInterp.f90:53</a></div></div>
<div class="ttc" id="read_8cpp_html_af3394b59e62576c2c4e37b60f0012c9b"><div class="ttname"><a href="read_8cpp.html#af3394b59e62576c2c4e37b60f0012c9b">i</a></div><div class="ttdeci">blockLoc i</div><div class="ttdef"><b>Definition:</b> <a href="read_8cpp_source.html#l00079">read.cpp:79</a></div></div>
<div class="ttc" id="classrocfracmain_html_ade382b3b948b8dccc8e8f2800c4ac092"><div class="ttname"><a href="classrocfracmain.html#ade382b3b948b8dccc8e8f2800c4ac092">rocfracmain::rocfracupdateinbuff</a></div><div class="ttdeci">subroutine rocfracupdateinbuff(glb, alpha)</div><div class="ttdef"><b>Definition:</b> <a href="RocFracMain_8f90_source.html#l02007">RocFracMain.f90:2007</a></div></div>
<div class="ttc" id="principal__stress_8f90_html_a8dea13bc134f9f4da9c7f32d06e6d497"><div class="ttname"><a href="principal__stress_8f90.html#a8dea13bc134f9f4da9c7f32d06e6d497">principal_stress</a></div><div class="ttdeci">subroutine principal_stress(s11, s22, s33, s12, s23, s13, istrgss, NumElVol, SVonMises)</div><div class="ttdef"><b>Definition:</b> <a href="principal__stress_8f90_source.html#l00053">principal_stress.f90:53</a></div></div>
<div class="ttc" id="bc__enforce_8f90_html_ac0b1c3d87ec07553fd6ba16768f8fe4d"><div class="ttname"><a href="bc__enforce_8f90.html#ac0b1c3d87ec07553fd6ba16768f8fe4d">bc_enforce</a></div><div class="ttdeci">subroutine bc_enforce(numbound, numnp, id, r, slope, prop, vb, ab, v, a, d, delta, Rnet, xm, DampEnabled, CurrTime)</div><div class="ttdef"><b>Definition:</b> <a href="bc__enforce_8f90_source.html#l00053">bc_enforce.f90:53</a></div></div>
<div class="ttc" id="implicit__finalize_8f90_html_a3695ac9fa4767e80d533c5bbf191cb98"><div class="ttname"><a href="implicit__finalize_8f90.html#a3695ac9fa4767e80d533c5bbf191cb98">implicit_finalize</a></div><div class="ttdeci">subroutine implicit_finalize(global)</div><div class="ttdef"><b>Definition:</b> <a href="implicit__finalize_8f90_source.html#l00073">implicit_finalize.f90:73</a></div></div>
<div class="ttc" id="VolRatio_8f90_html_ae26fa72649c2a5908244b9e503f0fc5c"><div class="ttname"><a href="VolRatio_8f90.html#ae26fa72649c2a5908244b9e503f0fc5c">volratio</a></div><div class="ttdeci">subroutine volratio(n1, n2, n3, n4, AlphaR, coor, numnp, NdMassLump)</div><div class="ttdef"><b>Definition:</b> <a href="VolRatio_8f90_source.html#l00053">VolRatio.f90:53</a></div></div>
<div class="ttc" id="vol__elem__mat__ortho_8f90_html_a1be6b83b96ffea4226a4faaa4d34e585"><div class="ttname"><a href="vol__elem__mat__ortho_8f90.html#a1be6b83b96ffea4226a4faaa4d34e585">vol_elem_mat_ortho</a></div><div class="ttdeci">subroutine vol_elem_mat_ortho(ci_full, ci, NumMatVol, NumMatOrtho, MatOrtho, E11, E22, E33, xnu12, xnu13, xnu23, G12, G13, G23, vx1o, vy1o, vz1o, vx2o, vy2o, vz2o, vx3o, vy3o, vz3o)</div><div class="ttdef"><b>Definition:</b> <a href="vol__elem__mat__ortho_8f90_source.html#l00053">vol_elem_mat_ortho.f90:53</a></div></div>
<div class="ttc" id="structrocstar__rocfrac_1_1rocfrac__global_html"><div class="ttname"><a href="structrocstar__rocfrac_1_1rocfrac__global.html">rocstar_rocfrac::rocfrac_global</a></div><div class="ttdef"><b>Definition:</b> <a href="ROCSTAR__RocFrac_8f90_source.html#l00080">ROCSTAR_RocFrac.f90:80</a></div></div>
<div class="ttc" id="max__dt__solid_8f90_html_a3fdf1ef4d6b59c269d39c74d56a38b62"><div class="ttname"><a href="max__dt__solid_8f90.html#a3fdf1ef4d6b59c269d39c74d56a38b62">max_dt_solid</a></div><div class="ttdeci">subroutine max_dt_solid(dt_courant, glb)</div><div class="ttdef"><b>Definition:</b> <a href="max__dt__solid_8f90_source.html#l00053">max_dt_solid.f90:53</a></div></div>
<div class="ttc" id="classvector3d_html_acd0002100974a4648cdac68b2d732659"><div class="ttname"><a href="classvector3d.html#acd0002100974a4648cdac68b2d732659">vector3d::mag</a></div><div class="ttdeci">real mag(void) const </div><div class="ttdef"><b>Definition:</b> <a href="vector3d_8h_source.html#l00130">vector3d.h:130</a></div></div>
<div class="ttc" id="UpdateMassMatrix_8f90_html_ad0bd8790ced9e6375c63e6664a39dd0d"><div class="ttname"><a href="UpdateMassMatrix_8f90.html#ad0bd8790ced9e6375c63e6664a39dd0d">updatemassmatrix</a></div><div class="ttdeci">subroutine updatemassmatrix(glb)</div><div class="ttdef"><b>Definition:</b> <a href="UpdateMassMatrix_8f90_source.html#l00053">UpdateMassMatrix.f90:53</a></div></div>
<div class="ttc" id="TractLoad__Hex_8f90_html_ac16b880c9c30c0cd475bc66b823157b8"><div class="ttname"><a href="TractLoad__Hex_8f90.html#ac16b880c9c30c0cd475bc66b823157b8">tractload_hex</a></div><div class="ttdeci">subroutine tractload_hex(R_ex, numnp, InterfaceElemTract, InterfaceNumElems, InterfaceNumNodes, InterfaceElemConn, MapNode, LwrBnd, UppBnd, coor)</div><div class="ttdef"><b>Definition:</b> <a href="TractLoad__Hex_8f90_source.html#l00053">TractLoad_Hex.f90:53</a></div></div>
<div class="ttc" id="classAff__transformation__repS2_html_a2758e8c9df83e803e7509d563733f531"><div class="ttname"><a href="classAff__transformation__repS2.html#a2758e8c9df83e803e7509d563733f531">Aff_transformation_repS2::print</a></div><div class="ttdeci">virtual std::ostream &amp; print(std::ostream &amp;os) const </div><div class="ttdef"><b>Definition:</b> <a href="Aff__transformationS2_8h_source.html#l00277">Aff_transformationS2.h:277</a></div></div>
<div class="ttc" id="UpdateR__bar_8f90_html_adf00980ee61327d18a964c71d855daea"><div class="ttname"><a href="UpdateR__bar_8f90.html#adf00980ee61327d18a964c71d855daea">updaterbar</a></div><div class="ttdeci">subroutine updaterbar(glb, Rnet)</div><div class="ttdef"><b>Definition:</b> <a href="UpdateR__bar_8f90_source.html#l00053">UpdateR_bar.f90:53</a></div></div>
<div class="ttc" id="classGeoPrim_1_1CLine_html_ace0714fea207254cf9ff1fff7f352511"><div class="ttname"><a href="classGeoPrim_1_1CLine.html#ace0714fea207254cf9ff1fff7f352511">GeoPrim::CLine::slope</a></div><div class="ttdeci">CVector &amp; slope()</div><div class="ttdef"><b>Definition:</b> <a href="GeoPrimitives_8H_source.html#l01041">GeoPrimitives.H:1041</a></div></div>
<div class="ttc" id="enhanced__elem__maps__hex_8f90_html_afc29040442235f1bf58aeaecae6b97fd"><div class="ttname"><a href="enhanced__elem__maps__hex_8f90.html#afc29040442235f1bf58aeaecae6b97fd">enhanced_elem_maps_hex</a></div><div class="ttdeci">subroutine enhanced_elem_maps_hex(mixed_map, enhanced_map)</div><div class="ttdef"><b>Definition:</b> <a href="enhanced__elem__maps__hex_8f90_source.html#l00053">enhanced_elem_maps_hex.f90:53</a></div></div>
<div class="ttc" id="Indexing_8h_html_a09afaf7ba9cb315df406199a16c7a143"><div class="ttname"><a href="Indexing_8h.html#a09afaf7ba9cb315df406199a16c7a143">j</a></div><div class="ttdeci">j indices j</div><div class="ttdef"><b>Definition:</b> <a href="Indexing_8h_source.html#l00006">Indexing.h:6</a></div></div>
<div class="ttc" id="classupdatestructuralsoln_html"><div class="ttname"><a href="classupdatestructuralsoln.html">updatestructuralsoln</a></div><div class="ttdef"><b>Definition:</b> <a href="UpdateStructuralSoln_8f90_source.html#l00054">UpdateStructuralSoln.f90:54</a></div></div>
<div class="ttc" id="classGEM__DomainBoundary_html_afeb8272329bc2bf786b17489289bf7a9"><div class="ttname"><a href="classGEM__DomainBoundary.html#afeb8272329bc2bf786b17489289bf7a9">GEM_DomainBoundary::debug</a></div><div class="ttdeci">bool debug(bool s=true)</div><div class="ttdef"><b>Definition:</b> <a href="GEM_8H_source.html#l00193">GEM.H:193</a></div></div>
<div class="ttc" id="classvector3d_html_a32a8c538b96dac9c9d9298dd9d071a57"><div class="ttname"><a href="classvector3d.html#a32a8c538b96dac9c9d9298dd9d071a57">vector3d::dir</a></div><div class="ttdeci">vector3d dir(void) const </div><div class="ttdef"><b>Definition:</b> <a href="vector3d_8h_source.html#l00144">vector3d.h:144</a></div></div>
<div class="ttc" id="get__mat__stiffness_8f90_html_a5e45c37f6915d6ba6d11a22ee8bfc354"><div class="ttname"><a href="get__mat__stiffness_8f90.html#a5e45c37f6915d6ba6d11a22ee8bfc354">get_mat_stiffness</a></div><div class="ttdeci">subroutine get_mat_stiffness(e, dnu, dmat)</div><div class="ttdef"><b>Definition:</b> <a href="get__mat__stiffness_8f90_source.html#l00054">get_mat_stiffness.f90:54</a></div></div>
<div class="ttc" id="classrocfracsubinterface_html_a93c183aa2e5a67aed64b5a2f2541ac57"><div class="ttname"><a href="classrocfracsubinterface.html#a93c183aa2e5a67aed64b5a2f2541ac57">rocfracsubinterface::rocfracinterfaceinitial</a></div><div class="ttdeci">subroutine, public rocfracinterfaceinitial(glb, obtain_attr, surfIn)</div><div class="ttdef"><b>Definition:</b> <a href="RocFracSubInterface_8f90_source.html#l00063">RocFracSubInterface.f90:63</a></div></div>
<div class="ttc" id="classColor_html_af94d15b3f5e32b9137fc219dcb16bd53"><div class="ttname"><a href="classColor.html#af94d15b3f5e32b9137fc219dcb16bd53">Color::alpha</a></div><div class="ttdeci">unsigned char alpha() const </div><div class="ttdef"><b>Definition:</b> <a href="Color_8h_source.html#l00075">Color.h:75</a></div></div>
<div class="ttc" id="v3d10__ale_8f90_html_afb50cbe2574b28eb13668800d2676fb4"><div class="ttname"><a href="v3d10__ale_8f90.html#afb50cbe2574b28eb13668800d2676fb4">v3d10_ale</a></div><div class="ttdeci">subroutine v3d10_ale(v_bar, a_bar, d, vhalf, Rnet, E, xnu, rho, numnp, numat_vol, numlstet, matlstet, lmlstet, meshcoor, nstart, nend)</div><div class="ttdef"><b>Definition:</b> <a href="v3d10__ale_8f90_source.html#l00065">v3d10_ale.f90:65</a></div></div>
<div class="ttc" id="classrocfracmain_html_af8df50c77956c23e6df0da51df12145d"><div class="ttname"><a href="classrocfracmain.html#af8df50c77956c23e6df0da51df12145d">rocfracmain::rocfracsoln</a></div><div class="ttdeci">subroutine, public rocfracsoln(glb, CurrentTime, CurrentTimeStep, MAN_update_inbuff)</div><div class="ttdef"><b>Definition:</b> <a href="RocFracMain_8f90_source.html#l01138">RocFracMain.f90:1138</a></div></div>
<div class="ttc" id="readsdv_8f90_html_a5ee3bef9cabac0bc871f99eb4778379d"><div class="ttname"><a href="readsdv_8f90.html#a5ee3bef9cabac0bc871f99eb4778379d">readsdv</a></div><div class="ttdeci">program readsdv</div><div class="ttdef"><b>Definition:</b> <a href="readsdv_8f90_source.html#l00023">readsdv.f90:23</a></div></div>
<div class="ttc" id="classrocfracmain_html_a12ffc754c70faa0a4631198391f72205"><div class="ttname"><a href="classrocfracmain.html#a12ffc754c70faa0a4631198391f72205">rocfracmain::rocfracfinalize</a></div><div class="ttdeci">subroutine, public rocfracfinalize(glb)</div><div class="ttdef"><b>Definition:</b> <a href="RocFracMain_8f90_source.html#l01124">RocFracMain.f90:1124</a></div></div>
<div class="ttc" id="FindProbe_8f90_html_ae1dc3b0df1f704457bcbb9d59aff6a01"><div class="ttname"><a href="FindProbe_8f90.html#ae1dc3b0df1f704457bcbb9d59aff6a01">findprobe</a></div><div class="ttdeci">subroutine findprobe(glb, myid)</div><div class="ttdef"><b>Definition:</b> <a href="FindProbe_8f90_source.html#l00053">FindProbe.f90:53</a></div></div>
<div class="ttc" id="thermal__soln_8f90_html_aea32be7524872ece15e425260e4e832e"><div class="ttname"><a href="thermal__soln_8f90.html#aea32be7524872ece15e425260e4e832e">thermal_soln</a></div><div class="ttdeci">subroutine thermal_soln(delt, t, rext_in, global, istep)</div><div class="ttdef"><b>Definition:</b> <a href="thermal__soln_8f90_source.html#l00025">thermal_soln.f90:25</a></div></div>
<div class="ttc" id="HeatLoad__Hex_8f90_html_a7069c1af7cb565c5c9684f47dbde422e"><div class="ttname"><a href="HeatLoad__Hex_8f90.html#a7069c1af7cb565c5c9684f47dbde422e">heatload_hex</a></div><div class="ttdeci">subroutine heatload_hex(Q_ex, numnp, InterfaceHeatFlux, InterfaceNumElems, InterfaceNumNodes, InterfaceElemConn, MapNode, LwrBnd, UppBnd, coor)</div><div class="ttdef"><b>Definition:</b> <a href="HeatLoad__Hex_8f90_source.html#l00028">HeatLoad_Hex.f90:28</a></div></div>
<div class="ttc" id="classLine__2_html_a788c8fb7953bc03c442e6d905abe0c01"><div class="ttname"><a href="classLine__2.html#a788c8fb7953bc03c442e6d905abe0c01">Line_2::a</a></div><div class="ttdeci">RT a() const </div><div class="ttdef"><b>Definition:</b> <a href="Line__2_8h_source.html#l00140">Line_2.h:140</a></div></div>
<div class="ttc" id="v3d4__ale_8f90_html_a44858f7fcdde70ad6b1db53113fafb6f"><div class="ttname"><a href="v3d4__ale_8f90.html#a44858f7fcdde70ad6b1db53113fafb6f">v3d4_ale</a></div><div class="ttdeci">subroutine v3d4_ale(v_bar, a_bar, d, vhalf, Rnet, E, xnu, rho, numnp, numat_vol, numcstet, matcstet, lmcstet, meshcoor, nstart, nend)</div><div class="ttdef"><b>Definition:</b> <a href="v3d4__ale_8f90_source.html#l00053">v3d4_ale.f90:53</a></div></div>
<div class="ttc" id="v3d4__volume_8f90_html_a27225dda763a5c16405ad0b8c729ac8b"><div class="ttname"><a href="v3d4__volume_8f90.html#a27225dda763a5c16405ad0b8c729ac8b">v3d4_volume</a></div><div class="ttdeci">subroutine v3d4_volume(coor, lmcstet, matcstet, rho, numnp, numcstet, numat_vol, Disp, nstart, nend, TotalMass, TotalGeomVolp, TotalGeomUndefVolp, NumVertx)</div><div class="ttdef"><b>Definition:</b> <a href="v3d4__volume_8f90_source.html#l00053">v3d4_volume.f90:53</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_7a486b17d2021c0193d0e2d8b9cdf369.html">Rocstar-public_master</a></li><li class="navelem"><a class="el" href="dir_7bccc66522e83bb65c7741579a40ebb7.html">Rocfrac</a></li><li class="navelem"><a class="el" href="dir_da9900513e9101e1fb332edd6eae170f.html">SourceIMP</a></li><li class="navelem"><a class="el" href="dir_51a28f26457d55a6818f49535ee4ba83.html">Source</a></li><li class="navelem"><a class="el" href="MP_2Source_2RocFracMain_8f90.html">RocFracMain.f90</a></li>
    <li class="footer">Generated on Sun Mar 13 2016 03:27:44 for Rocstar by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.7 </li>
  </ul>
</div>
</body>
</html>
